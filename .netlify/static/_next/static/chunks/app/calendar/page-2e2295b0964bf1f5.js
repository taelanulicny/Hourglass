(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[85],{3721:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var r=a(5155),n=a(2115),s=a(5695);let l=Array.from({length:24},(e,t)=>t),o=["Su","M","Tu","W","Th","F","Sa"],i=["#DDE5ED","#F8E1D9","#E9E5F9","#E6F4EA","#FFF3BF","#FCE1E4","#E0F2FE"],c={title:"",area:"",dateYMD:"",start:"09:00",end:"10:00",notes:""};function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(e),a=t.getMinutes(),r=t.getHours();if(a>0&&23===(r+=1))return{start:"00:00",end:"01:00"};if(r>=24)return{start:"23:00",end:"23:59"};let n=Math.min(23,r+1),s=e=>String(e).padStart(2,"0");return{start:"".concat(s(r),":00"),end:"".concat(s(n),":00")}}function u(e){let t=new Date(e),a=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return"".concat(a,":").concat(r)}function h(e){if(!e||"string"!=typeof e)return 0;let[t,a]=e.split(":").map(Number);return(60*(Number.isFinite(t)?t:0)+(Number.isFinite(a)?a:0))*6e4}function m(e,t){let a=Math.min(Math.max(Math.floor((h(e)+(t||0))/6e4),0),1439),r=Math.floor(a/60);return"".concat(String(r).padStart(2,"0"),":").concat(String(a%60).padStart(2,"0"))}function x(e){if(!e)return new Date;let[t,a,r]=e.split("-").map(Number);return new Date(t,(a||1)-1,r||1)}function g(e){let t=new Date(e),a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(n)}function f(e){try{let t="focusCategories:week:".concat(g(function(e){let t=new Date(e);t.setHours(0,0,0,0);let a=t.getDay();return t.setDate(t.getDate()-(a+6)%7),t}(e))),a=localStorage.getItem(t);if(a){let e=JSON.parse(a);if(Array.isArray(e))return e}}catch(e){}try{let e=localStorage.getItem("focusCategories"),t=e?JSON.parse(e):[];return Array.isArray(t)?t:[]}catch(e){return[]}}function p(e){return x(e).toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric"})}function v(e){let t=new Date(e);return t.setDate(1),t.setHours(0,0,0,0),t}function b(e,t){let a=new Date(e);return a.setMonth(a.getMonth()+t),a}function w(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function y(e){let{valueYMD:t,onChange:a,onClose:s}=e,l=t?x(t):new Date,[o,i]=(0,n.useState)(v(l)),c=function(e){let t=v(e),a=new Date(t);a.setDate(1-t.getDay());let r=[];for(let e=0;e<42;e++){let t=new Date(a);t.setDate(a.getDate()+e),r.push(t)}return r}(o),d=new Date;d.setHours(0,0,0,0);let u=x(t||g(new Date));return(0,r.jsxs)("div",{className:"absolute z-50 mt-1 w-72 rounded-lg border border-gray-200 bg-white shadow-lg p-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-1 pb-2",children:[(0,r.jsx)("button",{className:"px-2 py-1 rounded hover:bg-gray-100",onClick:()=>i(b(o,-1)),"aria-label":"Previous month",children:"‹"}),(0,r.jsx)("div",{className:"font-semibold text-[#4E4034]",children:o.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,r.jsx)("button",{className:"px-2 py-1 rounded hover:bg-gray-100",onClick:()=>i(b(o,1)),"aria-label":"Next month",children:"›"})]}),(0,r.jsx)("div",{className:"grid grid-cols-7 text-center text-[11px] text-gray-500",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>(0,r.jsx)("div",{className:"py-1",children:e},e))}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-1",children:c.map((e,n)=>{let l=e.getMonth()===o.getMonth(),i=t&&w(e,u),c=w(e,d);return(0,r.jsx)("button",{onClick:()=>{a&&a(g(e)),s&&s()},className:"h-9 rounded-md text-sm ".concat(l?"text-[#4E4034]":"text-gray-400"," ").concat(i?"bg-[#8CA4AF] text-white":"hover:bg-gray-100"," ").concat(c&&!i?"ring-1 ring-[#8CA4AF]":""),title:e.toDateString(),children:e.getDate()},n)})})]})}function j(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),a=(()=>{let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>t(!0),[]),e})(),v=(0,n.useMemo)(()=>{let e=new Date;return e.setHours(0,0,0,0),e},[]),[b,w]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=new Date;e.setHours(0,0,0,0),w(e)},[]);let[j,N]=(0,n.useState)([]);(0,n.useEffect)(()=>{N(f(new Date))},[]),(0,n.useEffect)(()=>{let e=e=>{e.key&&(e.key.startsWith("focusCategories")||"focusCategories"===e.key)&&b&&N(f(b))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[b]);let[D,S]=(0,n.useState)(!1),[M,C]=(0,n.useState)(!1),[k,E]=(0,n.useState)(()=>({...c,...d(new Date),dateYMD:g(new Date)}));(0,n.useEffect)(()=>{if((D||M)&&b){let e=f(b);N(e),E(t=>(null==t?void 0:t.area)?(e||[]).some(e=>e.label===t.area)?t:{...t,area:""}:t)}},[D,M,b]);let F=e=>{let t=(j||[]).find(t=>t.label===e);return(null==t?void 0:t.color)||i[2]},A=["hourglassEvents:v1","calendarEvents","calendar-items","events"],[L,Y]=(0,n.useState)([]),[I,R]=(0,n.useState)(!1);(0,n.useEffect)(()=>{try{console.log("Calendar: Loading events on mount...");let e=[],t=new Set;for(let a of A){let r=localStorage.getItem(a);if(console.log('Calendar: Checking localStorage key "'.concat(a,'":'),r?"has data":"empty"),r)try{let n=JSON.parse(r)||[];if(Array.isArray(n))for(let r of(console.log("Calendar: Found ".concat(n.length," events in ").concat(a,":"),n),n)){let a=r&&(r.id||"".concat(r.title||"","-").concat(r.start||""));a&&!t.has(a)&&(t.add(a),e.push(r))}}catch(e){console.warn("Calendar: Failed to parse ".concat(a,":"),e)}}console.log("Calendar: Total collected events:",e.length,e),e.length&&Y(e)}catch(e){console.warn("Failed to read events from storage",e)}finally{R(!0)}},[]),(0,n.useEffect)(()=>{if(I)try{let e=JSON.stringify(L);localStorage.setItem("hourglassEvents:v1",e),localStorage.setItem("calendarEvents",e)}catch(e){console.warn("Failed to write events to storage",e)}},[L,I]),(0,n.useEffect)(()=>{let e=e=>{if(e.key&&A.includes(e.key))try{console.log("Calendar: Storage event detected:",e.key,e.newValue);let t=e.newValue?JSON.parse(e.newValue):null;Array.isArray(t)&&(console.log("Calendar: Updating events from storage event:",t),Y(t))}catch(e){console.warn("Calendar: Failed to parse storage event:",e)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,n.useEffect)(()=>{let e=()=>{try{console.log("Calendar: Received calendarEventsUpdated event, refreshing events...");let e=[],t=new Set;for(let a of A){let r=localStorage.getItem(a);if(r)try{let a=JSON.parse(r)||[];if(Array.isArray(a))for(let r of a){let a=r&&(r.id||"".concat(r.title||"","-").concat(r.start||""));a&&!t.has(a)&&(t.add(a),e.push(r))}}catch(e){}}console.log("Calendar: Updating events from localStorage:",{collectedCount:e.length,events:e}),Y(e)}catch(e){console.warn("Failed to read events from storage on calendarEventsUpdated",e)}};return window.addEventListener("calendarEventsUpdated",e),()=>window.removeEventListener("calendarEventsUpdated",e)},[]),(0,n.useEffect)(()=>{N(f(b)),E(e=>(null==e?void 0:e.area)?(f(b)||[]).some(t=>t.label===e.area)?e:{...e,area:""}:e)},[b]),(0,n.useEffect)(()=>{if(!t)return;let a=t.get("new");if("1"!==a&&"true"!==a)return;let r=t.get("date"),n=t.get("focus");if(r)try{w(x(r))}catch(e){}E(e=>({...c,...d(new Date),area:n?decodeURIComponent(n):e.area,dateYMD:r||g(b)})),S(!0);try{e.replace("/calendar",{scroll:!1})}catch(e){}},[t]);let H=(0,n.useMemo)(()=>b?b.toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric"}):"Loading...",[b]),U=(0,n.useRef)(null),P=(0,n.useRef)([]),T=(0,n.useRef)(null),W=(0,n.useRef)(null),B=(0,n.useMemo)(()=>{let e=new Date(v);return e.setDate(e.getDate()-14),Array.from({length:29},(t,a)=>{let r=new Date(e);return r.setDate(e.getDate()+a),r})},[v]);(0,n.useEffect)(()=>{var e;if(!U.current||!(null==(e=P.current)?void 0:e.length)||!b)return;let t=B.findIndex(e=>e.toDateString()===b.toDateString());if(-1===t)return;let a=Math.max(0,t-1),r=P.current[a];if(!r)return;let n=r.offsetLeft-24;U.current.scrollTo({left:n,top:0,behavior:"auto"})},[b,B]);let[O,z]=(0,n.useState)(null),[J,_]=(0,n.useState)(36e5),[V,$]=(0,n.useState)(!1);(0,n.useRef)();let[K,q]=(0,n.useState)(!1);(0,n.useRef)();let[G,Q]=(0,n.useState)(0);(0,n.useEffect)(()=>{Q(Date.now());let e=setInterval(()=>Q(Date.now()),3e4);return()=>clearInterval(e)},[]);let[X,Z]=(0,n.useState)(null),[ee,et]=(0,n.useState)(null),ea=(0,n.useRef)({startY:0,origStart:0,origEnd:0,duration:0,lastStartMs:null,moved:!1}),er=(0,n.useMemo)(()=>{if(!b)return 0;let e=new Date(b);return e.setHours(0,0,0,0),e.getTime()},[b]),en=(0,n.useMemo)(()=>er?er+864e5:0,[er]),es=(0,n.useMemo)(()=>{if(!b||!G)return null;let e=new Date(G);return e.getFullYear()!==b.getFullYear()||e.getMonth()!==b.getMonth()||e.getDate()!==b.getDate()?null:(60*e.getHours()+e.getMinutes())/60*64},[G,b,64]);(0,n.useEffect)(()=>{if(null==es||!W.current)return;let e=W.current.getBoundingClientRect(),t=Math.max(0,window.scrollY+e.top+es-120);window.scrollTo({top:t,behavior:"smooth"})},[es,b]),(0,n.useEffect)(()=>{if(!X)return;let e=document.body.style.touchAction,t=document.body.style.userSelect;document.body.style.touchAction="none",document.body.style.userSelect="none";let a=e=>{e.cancelable&&e.preventDefault();let t=(e.touches?e.touches[0].clientY:e.clientY)-ea.current.startY,a=ea.current.origStart+t/64*36e5,r=a+ea.current.duration;r=(a=3e5*Math.round(a/3e5))+ea.current.duration,[a,r]=((e,t)=>{let a=t-e,r=Math.max(er,Math.min(e,en-a));return[r,r+a]})(a,r),ea.current.lastStartMs=a,ea.current.moved=!0;let n=new Date(Math.max(a,er));et(Math.max(0,(n.getHours()+n.getMinutes()/60)*64))},r=()=>{let e=ea.current.moved,t=ea.current.lastStartMs,a=ea.current.duration;if(Z(null),et(null),ea.current={startY:0,origStart:0,origEnd:0,duration:0,lastStartMs:null,moved:!1},!e||null==t)return;let r=t+a;Y(e=>e.map(e=>e.id===X?{...e,start:t,end:r}:e))};return window.addEventListener("mousemove",a,{passive:!1}),window.addEventListener("mouseup",r,{passive:!0}),window.addEventListener("touchmove",a,{passive:!1}),window.addEventListener("touchend",r,{passive:!0}),()=>{document.body.style.touchAction=e,document.body.style.userSelect=t,window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",r),window.removeEventListener("touchmove",a),window.removeEventListener("touchend",r)}},[X,64,er,en]);let el=(0,n.useMemo)(()=>er&&en?L.filter(e=>e.end>er&&e.start<en):[],[L,er,en]);return(b&&o[b.getDay()],b)?(0,r.jsxs)("div",{className:"min-h-screen bg-white text-[#4E4034] pb-36",children:[(0,r.jsxs)("header",{className:"sticky top-0 bg-[#F7F6F3] px-4 py-3 shadow-sm z-10 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{className:"text-lg px-2","aria-label":"Previous Day",onClick:()=>b&&w(new Date(b.getFullYear(),b.getMonth(),b.getDate()-1)),disabled:!b,children:"‹"}),(0,r.jsx)("div",{className:"font-semibold",children:H}),(0,r.jsx)("button",{className:"text-lg px-2","aria-label":"Next Day",onClick:()=>b&&w(new Date(b.getFullYear(),b.getMonth(),b.getDate()+1)),disabled:!b,children:"›"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>{console.log("Calendar: Manual refresh requested");let e=[],t=new Set;for(let a of A){let r=localStorage.getItem(a);if(r)try{let a=JSON.parse(r)||[];if(Array.isArray(a))for(let r of a){let a=r&&(r.id||"".concat(r.title||"","-").concat(r.start||""));a&&!t.has(a)&&(t.add(a),e.push(r))}}catch(e){console.warn("Calendar: Failed to parse ".concat(a,":"),e)}}console.log("Calendar: Manual refresh found events:",e),Y(e)},"aria-label":"Refresh Events",title:"Refresh Events",className:"p-2 rounded-full border border-[#BCA88F] text-[#4E4034] hover:bg-white/60",children:(0,r.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),(0,r.jsx)("path",{d:"M21 3v5h-5"}),(0,r.jsx)("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),(0,r.jsx)("path",{d:"M3 21v-5h5"})]})}),(0,r.jsx)("button",{onClick:()=>{console.log("Calendar: Current events state:",L),console.log("Calendar: localStorage hourglassEvents:v1:",localStorage.getItem("hourglassEvents:v1")),console.log("Calendar: localStorage calendarEvents:",localStorage.getItem("calendarEvents"))},"aria-label":"Show Events Debug",title:"Show Events Debug",className:"p-2 rounded-full border border-gray-300 text-gray-600 hover:bg-gray-100",children:(0,r.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M9 12l2 2 4-4"}),(0,r.jsx)("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"})]})}),(0,r.jsx)("button",{onClick:()=>e.push("/account"),"aria-label":"Account",title:"Account",className:"p-2 rounded-full border border-[#BCA88F] text-[#BCA88F] hover:bg-white/60",children:(0,r.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("rect",{x:"6",y:"2.5",width:"12",height:"3",rx:"1.5"}),(0,r.jsx)("rect",{x:"6",y:"18.5",width:"12",height:"3",rx:"1.5"}),(0,r.jsx)("path",{d:"M8 6c0 3.2 2.2 4.7 4 6-1.8 1.3-4 2.8-4 6"}),(0,r.jsx)("path",{d:"M16 6c0 3.2-2.2 4.7-4 6 1.8 1.3 4 2.8 4 6"})]})})]})]}),(0,r.jsx)("div",{ref:U,className:"flex gap-2 overflow-x-auto px-3 pt-2 pb-1 mb-3 bg-[#ECEAE6] rounded-md bg-white",children:B.map((e,t)=>{let a=b&&e.toDateString()===b.toDateString(),n=e.toDateString()===v.toDateString();return(0,r.jsxs)("button",{ref:e=>P.current[t]=e,onClick:()=>w(new Date(e)),className:"relative flex flex-col items-center w-14 flex-shrink-0 py-2 rounded-md border outline-none focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 ".concat(a?"bg-[#8CA4AF] text-white border-transparent":"text-[#4E4034] bg-transparent border-transparent"),title:e.toDateString(),children:[(0,r.jsx)("div",{className:"text-[11px]",children:o[e.getDay()]}),(0,r.jsx)("div",{className:"text-sm font-semibold",children:e.getDate()}),(0,r.jsx)("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-[#8CA4AF] ".concat(n&&!a?"opacity-100":"opacity-0")})]},t)})}),(0,r.jsx)("div",{ref:T,className:"relative px-2",children:(0,r.jsxs)("div",{className:"grid grid-cols-[56px_minmax(0,1fr)]",children:[(0,r.jsx)("div",{className:"flex flex-col items-end pr-2",children:a&&l.map(e=>(0,r.jsx)("div",{className:"text-xs text-gray-500 flex items-start",style:{height:"".concat(64,"px")},children:(0,r.jsx)("div",{className:"-translate-y-1",children:"".concat(e%12==0?12:e%12," ").concat(e<12?"AM":"PM")})},e))}),(0,r.jsxs)("div",{ref:W,className:"relative border-l border-gray-200 overflow-visible",style:{touchAction:X?"none":void 0,userSelect:X?"none":void 0},children:[l.map(e=>(0,r.jsx)("div",{className:"h-16 border-b border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>{b&&(E({...c,dateYMD:g(b),start:"".concat(String(e).padStart(2,"0"),":00"),end:23===e?"23:59":"".concat(String(e+1).padStart(2,"0"),":00")}),S(!0))}},e)),a&&null!=es&&(0,r.jsxs)("div",{className:"pointer-events-none absolute inset-x-0 z-20",style:{top:Math.max(0,Math.min(es,1535))+"px"},children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",className:"absolute -left-3 -translate-y-1/2",style:{top:0},"aria-hidden":"true",children:[(0,r.jsx)("rect",{x:"6",y:"2.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("rect",{x:"6",y:"18.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M8 6c0 3.2 2.2 4.7 4 6-1.8 1.3-4 2.8-4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M16 6c0 3.2-2.2 4.7-4 6 1.8 1.3 4 2.8 4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,r.jsx)("div",{className:"absolute right-0 -translate-y-full mb-1 px-1.5 py-0.5 text-[10px] rounded bg-red-500 text-white shadow",style:{top:0},"aria-hidden":"true",children:function(e){let t=new Date(e),a=t.getHours(),r=String(t.getMinutes()).padStart(2,"0");return"".concat((a+11)%12+1,":").concat(r," ").concat(a>=12?"PM":"AM")}(G)}),(0,r.jsx)("div",{className:"h-[2px] bg-red-500 w-full"})]}),a&&el.map(e=>{let t=Math.max(e.start,er),a=Math.min(e.end,en),n=new Date(t),s=(n.getHours()+n.getMinutes()/60)*64,l=F(e.area)||e.color||i[2];return(0,r.jsx)("div",{className:"absolute left-1 right-1 rounded-md shadow ".concat(X===e.id?"cursor-grabbing":"cursor-grab"),style:{top:(X===e.id&&null!=ee?ee:Math.max(0,s))+"px",height:Math.max(24,(a-t)/36e5*64)+"px",background:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4;if(!e)return"rgba(0,0,0,".concat(t,")");let a=e.trim();if(/^#([0-9a-f]{3}){1,2}$/i.test(a)){let e,r,n;return 4===a.length?(e=parseInt(a[1]+a[1],16),r=parseInt(a[2]+a[2],16),n=parseInt(a[3]+a[3],16)):(e=parseInt(a.slice(1,3),16),r=parseInt(a.slice(3,5),16),n=parseInt(a.slice(5,7),16)),"rgba(".concat(e,", ").concat(r,", ").concat(n,", ").concat(t,")")}let r=a.match(/^rgba?\(([^)]+)\)$/i);if(r){let[e,a,n]=r[1].split(",").map(e=>e.trim());return"rgba(".concat(Number(e),", ").concat(Number(a),", ").concat(Number(n),", ").concat(t,")")}return a}(l,.4),borderLeft:"3px solid ".concat(l),willChange:X===e.id?"top":void 0},title:e.title,onMouseDown:t=>{t.preventDefault();let a=e.end-e.start;Z(e.id),ea.current={startY:t.clientY,origStart:e.start,origEnd:e.end,duration:a,lastStartMs:null,moved:!1};let r=new Date(Math.max(e.start,er));et(Math.max(0,(r.getHours()+r.getMinutes()/60)*64))},onTouchStart:t=>{t.preventDefault();let a=t.touches[0],r=e.end-e.start;Z(e.id),ea.current={startY:a.clientY,origStart:e.start,origEnd:e.end,duration:r,lastStartMs:null,moved:!1};let n=new Date(Math.max(e.start,er));et(Math.max(0,(n.getHours()+n.getMinutes()/60)*64))},onClick:t=>{if(ea.current.moved)t.preventDefault(),t.stopPropagation();else z(e.id),_(Math.max(0,(e.end||0)-(e.start||0))||36e5),E({title:e.title||"",area:e.area||"",dateYMD:g(new Date(e.start)),start:u(e.start),end:u(e.end),notes:e.notes||""}),C(!0)},children:(0,r.jsxs)("div",{className:"text-[11px] px-2 py-1 leading-tight",children:[(0,r.jsx)("div",{className:"font-semibold truncate",children:e.title}),e.area&&(0,r.jsx)("div",{className:"text-[10px] opacity-70 truncate",children:e.area})]})},e.id)})]})]})}),(0,r.jsx)("button",{onClick:()=>{E({...c,...d(new Date),dateYMD:g(b)}),S(!0)},className:"fixed bottom-20 right-4 bg-[#8CA4AF] text-white rounded-full w-12 h-12 flex items-center justify-center text-2xl shadow-md","aria-label":"Add Event",children:"+"}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-3 pb-7 z-50",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto grid grid-cols-3 gap-3",children:[(0,r.jsx)("button",{onClick:()=>e.push("/"),className:"h-12 w-full rounded-2xl bg-white text-gray-700 font-medium border-2 border-gray-200 hover:bg-gray-50 transition-colors duration-200 shadow-sm",children:"Dashboard"}),(0,r.jsx)("button",{className:"h-12 w-full rounded-2xl bg-gray-900 text-white font-semibold shadow-lg",disabled:!0,"aria-current":"page",children:"Calendar"}),(0,r.jsx)("button",{onClick:()=>e.push("/connect"),className:"h-12 w-full rounded-2xl bg-white text-gray-700 font-medium border-2 border-gray-200 hover:bg-gray-50 transition-colors duration-200 shadow-sm",children:"Connect"})]})}),(0,r.jsx)("div",{className:"fixed left-0 right-0 bottom-24 z-40 flex flex-row gap-2 px-4 justify-center pointer-events-none select-none",children:[...j].reverse().map((e,t)=>{let{label:a,timeSpent:n,goal:s,days:l,color:c}=e,d=o[new Date().getDay()],u=Number(s||0),h=Number(l&&l[d]||0),m=Math.min(u>0?h/u*100:0,100).toFixed(0),x=u>0?(h-u)/u*100:0,g=h>u?Math.min(x,100).toFixed(0):0,f={color:c},p=(null==f?void 0:f.color)||"#8CA4AF",v=Math.abs((u||0)-(h||0));return p||i[t%i.length],(0,r.jsxs)("div",{className:"flex flex-col items-center pointer-events-auto",children:[(0,r.jsxs)("svg",{width:54,height:54,viewBox:"0 0 36 36",className:"block mb-1",children:[(0,r.jsx)("path",{className:"text-gray-300",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,r.jsx)("path",{stroke:p,strokeOpacity:"0.55",strokeWidth:"3",strokeDasharray:"".concat(m,", 100"),strokeLinecap:"round",fill:"none",transform:"rotate(-90 18 18)",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),g>0&&(0,r.jsx)("g",{transform:"scale(0.88) translate(2.2 2.2)",children:(0,r.jsx)("path",{stroke:p,strokeWidth:"2.2",strokeDasharray:"".concat(g,", 100"),strokeLinecap:"round",fill:"none",transform:"rotate(-90 18 18)",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})}),(0,r.jsx)("foreignObject",{x:"8",y:"8",width:"20",height:"20",children:(0,r.jsxs)("div",{xmlns:"http://www.w3.org/1999/xhtml",className:"w-full h-full flex flex-col items-center justify-center leading-tight",children:[(0,r.jsx)("div",{className:"text-[10px] font-bold text-[#4E4034]",children:function(e){let t=Math.max(0,Number(e)||0);if(t<1){let e=Math.round(60*t);return"".concat(e," ").concat(1===e?"min":"mins")}return"".concat((Math.round(10*(Number(t)||0))/10).toFixed(1).replace(/\.0$/,"")).concat(1===Number(t)?"hr":"hrs")}(v)}),(0,r.jsx)("div",{className:"text-[8px] uppercase text-gray-500 -mt-0.5",children:h>u?"OVER":"LEFT"})]})})]}),(0,r.jsx)("div",{className:"text-xs font-medium text-[#4E4034] truncate max-w-[60px]",children:a})]},a)})}),D&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/10 backdrop-blur-sm flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-4 w-[92%] max-w-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"New Event"}),(0,r.jsx)("button",{className:"text-sm",onClick:()=>{S(!1),E(c)},children:"Cancel"})]}),(0,r.jsx)("label",{className:"text-sm",children:"Title"}),(0,r.jsx)("input",{value:k.title,onChange:e=>E({...k,title:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3",placeholder:"e.g., Product Development"}),(0,r.jsx)("label",{className:"text-sm",children:"Focus Area"}),(0,r.jsxs)("select",{value:k.area,onChange:e=>E({...k,area:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3",children:[(0,r.jsx)("option",{value:"",children:"(none)"}),j.map(e=>(0,r.jsx)("option",{value:e.label,children:e.label},e.label))]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full border",style:{background:F(k.area)}}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"Event color follows the Focus Area"})]}),(0,r.jsx)("label",{className:"text-sm",children:"Date"}),(0,r.jsxs)("div",{className:"relative mb-3",children:[(0,r.jsx)("div",{role:"button",tabIndex:0,className:"w-full border rounded px-3 py-2 text-left bg-white cursor-pointer",onClick:()=>$(e=>!e),onKeyPress:e=>{("Enter"===e.key||" "===e.key)&&$(e=>!e)},children:p(k.dateYMD)}),V&&(0,r.jsx)("div",{className:"absolute left-0 z-50",children:(0,r.jsx)(y,{valueYMD:k.dateYMD,onChange:e=>E(t=>({...t,dateYMD:e})),onClose:()=>$(!1)})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3 items-start overflow-hidden",children:[(0,r.jsxs)("div",{className:"pr-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm",children:"Start"}),(0,r.jsx)("input",{type:"time",value:k.start,onChange:e=>{let t=e.target.value,a=m(t,J);E(e=>({...e,start:t,end:a}))},className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px]",min:"00:00",max:"23:59",style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:"pl-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm",children:"End"}),(0,r.jsx)("input",{type:"time",value:k.end,onChange:e=>E({...k,end:e.target.value}),className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px]",min:"00:00",max:"23:59",style:{width:"100%"}})]})]}),(0,r.jsx)("label",{className:"text-sm",children:"Notes"}),(0,r.jsx)("textarea",{value:k.notes,onChange:e=>E({...k,notes:e.target.value}),className:"w-full border rounded px-3 py-2 mb-4",rows:3,placeholder:"What will you accomplish during this timeframe?"}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded",onClick:()=>{S(!1),E(c)},children:"Close"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-[#BCA88F] text-white rounded",onClick:()=>{if(!k.title&&!k.area||!b)return;let e=x(k.dateYMD||g(b)),t=t=>{let[a,r]=t.split(":").map(Number),n=new Date(e);return n.setHours(a,r,0,0),n.getTime()},a=t(k.start),r=t(k.end);r<=a&&(r+=864e5);let n=F(k.area);Y([...L,{id:function(){try{if("undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID)return crypto.randomUUID();if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues){let e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t=Array.from(e,e=>e.toString(16).padStart(2,"0")).join("");return"".concat(t.slice(0,8),"-").concat(t.slice(8,12),"-").concat(t.slice(12,16),"-").concat(t.slice(16,20),"-").concat(t.slice(20))}}catch(e){}return"evt-".concat(Date.now().toString(36),"-").concat(Math.random().toString(36).slice(2,8))}(),title:k.title||k.area,area:k.area||"",start:a,end:r,color:n,notes:k.notes||""}]),w(new Date(e)),S(!1),E(c)},children:"Add"})]})]})}),M&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/10 backdrop-blur-sm flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-4 w-[92%] max-w-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"Edit Event"}),(0,r.jsx)("button",{className:"text-sm",onClick:()=>{C(!1),z(null)},children:"Close"})]}),(0,r.jsx)("label",{className:"text-sm",children:"Title"}),(0,r.jsx)("input",{value:k.title,onChange:e=>E({...k,title:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3"}),(0,r.jsx)("label",{className:"text-sm",children:"Focus Area"}),(0,r.jsxs)("select",{value:k.area,onChange:e=>E({...k,area:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3",children:[(0,r.jsx)("option",{value:"",children:"(none)"}),j.map(e=>(0,r.jsx)("option",{value:e.label,children:e.label},e.label))]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full border",style:{background:F(k.area||"")}}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"Color auto-updates from Focus Area"})]}),(0,r.jsx)("label",{className:"text-sm",children:"Date"}),(0,r.jsxs)("div",{className:"relative mb-3",children:[(0,r.jsx)("div",{role:"button",tabIndex:0,className:"w-full border rounded px-3 py-2 text-left bg-white cursor-pointer",onClick:()=>q(e=>!e),onKeyPress:e=>{("Enter"===e.key||" "===e.key)&&q(e=>!e)},children:p(k.dateYMD)}),K&&(0,r.jsx)("div",{className:"absolute left-0 z-50",children:(0,r.jsx)(y,{valueYMD:k.dateYMD,onChange:e=>E(t=>({...t,dateYMD:e})),onClose:()=>q(!1)})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3 items-start overflow-hidden",children:[(0,r.jsxs)("div",{className:"pr-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm",children:"Start"}),(0,r.jsx)("input",{type:"time",value:k.start,onChange:e=>{let t=e.target.value,a=m(t,J);E(e=>({...e,start:t,end:a}))},className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px]",min:"00:00",max:"23:59",style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:"pl-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm",children:"End"}),(0,r.jsx)("input",{type:"time",value:k.end,onChange:e=>{let t=e.target.value,a=Math.max(0,h(t)-h(k.start));a>0&&_(a),E(e=>({...e,end:t}))},className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px]",min:"00:00",max:"23:59",style:{width:"100%"}})]})]}),(0,r.jsx)("label",{className:"text-sm",children:"Notes"}),(0,r.jsx)("textarea",{value:k.notes,onChange:e=>E({...k,notes:e.target.value}),className:"w-full border rounded px-3 py-2 mb-4",rows:3}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-red-500 text-white rounded",onClick:()=>{O&&(Y(L.filter(e=>e.id!==O)),C(!1),z(null))},children:"Delete"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded",onClick:()=>{C(!1),z(null)},children:"Cancel"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-[#BCA88F] text-white rounded",onClick:()=>{if(!O)return;let e=x(k.dateYMD||g(b)),t=t=>{let[a,r]=t.split(":").map(Number),n=new Date(e);return n.setHours(a,r,0,0),n.getTime()},a=t(k.start),r=t(k.end);r<=a&&(r+=864e5),Y(L.map(e=>e.id===O?{...e,title:k.title||k.area,area:k.area||"",start:a,end:r,color:F(k.area||e.area),notes:k.notes||""}:e)),C(!1),z(null)},children:"Save"})]})]})]})})]}):(0,r.jsx)("div",{className:"min-h-screen bg-white text-[#4E4034] flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-lg font-semibold mb-2",children:"Loading Calendar..."}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Please wait while we prepare your calendar view."})]})})}function N(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-[#F7F6F3] flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-[#4E4034]",children:"Loading calendar..."})}),children:(0,r.jsx)(j,{})})}},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},9836:(e,t,a)=>{Promise.resolve().then(a.bind(a,3721))}},e=>{e.O(0,[441,964,358],()=>e(e.s=9836)),_N_E=e.O()}]);