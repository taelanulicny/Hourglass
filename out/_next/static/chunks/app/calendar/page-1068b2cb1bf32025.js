(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{3587:function(e,t,a){Promise.resolve().then(a.bind(a,8001))},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},8001:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Y}});var r=a(7437),l=a(2265),s=a(9376);let n=()=>{let[e,t]=(0,l.useState)(!1);return(0,l.useEffect)(()=>t(!0),[]),e},o=()=>{let[e,t]=(0,l.useState)({top:0,right:0,bottom:0,left:0}),a=n();return(0,l.useEffect)(()=>{if(a&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)){let e=getComputedStyle(document.documentElement),a=parseInt(e.getPropertyValue("env(safe-area-inset-top)")||"0",10);t({top:a,right:parseInt(e.getPropertyValue("env(safe-area-inset-right)")||"0",10),bottom:parseInt(e.getPropertyValue("env(safe-area-inset-bottom)")||"0",10),left:parseInt(e.getPropertyValue("env(safe-area-inset-left)")||"0",10)})}},[a]),e},i=Array.from({length:24},(e,t)=>t),c=["Su","M","Tu","W","Th","F","Sa"];function d(e){return"".concat(e%12==0?12:e%12," ").concat(e<12?"AM":"PM")}function u(e){let t=new Date(e),a=t.getHours(),r=String(t.getMinutes()).padStart(2,"0");return"".concat((a+11)%12+1,":").concat(r," ").concat(a>=12?"PM":"AM")}let h=["#DDE5ED","#F8E1D9","#E9E5F9","#E6F4EA","#FFF3BF","#FCE1E4","#E0F2FE"];function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4;if(!e)return"rgba(0,0,0,".concat(t,")");let a=e.trim();if(/^#([0-9a-f]{3}){1,2}$/i.test(a)){let e,r,l;return 4===a.length?(e=parseInt(a[1]+a[1],16),r=parseInt(a[2]+a[2],16),l=parseInt(a[3]+a[3],16)):(e=parseInt(a.slice(1,3),16),r=parseInt(a.slice(3,5),16),l=parseInt(a.slice(5,7),16)),"rgba(".concat(e,", ").concat(r,", ").concat(l,", ").concat(t,")")}let r=a.match(/^rgba?\(([^)]+)\)$/i);if(r){let[e,a,l]=r[1].split(",").map(e=>e.trim());return"rgba(".concat(Number(e),", ").concat(Number(a),", ").concat(Number(l),", ").concat(t,")")}return a}function x(){try{if("undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID)return crypto.randomUUID();if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues){let e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t=Array.from(e,e=>e.toString(16).padStart(2,"0")).join("");return"".concat(t.slice(0,8),"-").concat(t.slice(8,12),"-").concat(t.slice(12,16),"-").concat(t.slice(16,20),"-").concat(t.slice(20))}}catch(e){}return"evt-".concat(Date.now().toString(36),"-").concat(Math.random().toString(36).slice(2,8))}let g={title:"",area:"",dateYMD:"",start:"09:00",end:"10:00",notes:""};function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(e),a=t.getMinutes(),r=t.getHours();if(a>0&&23===(r+=1))return{start:"00:00",end:"01:00"};if(r>=24)return{start:"23:00",end:"23:59"};let l=Math.min(23,r+1),s=e=>String(e).padStart(2,"0");return{start:"".concat(s(r),":00"),end:"".concat(s(l),":00")}}function f(e){let t=new Date(e),a=t.getDay();return t.setHours(0,0,0,0),t.setDate(t.getDate()-a),t}function v(e){let t=new Date(e),a=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return"".concat(a,":").concat(r)}function b(e){if(!e||"string"!=typeof e)return 0;let[t,a]=e.split(":").map(Number);return(60*(Number.isFinite(t)?t:0)+(Number.isFinite(a)?a:0))*6e4}function y(e,t){let a=Math.min(Math.max(Math.floor((b(e)+(t||0))/6e4),0),1439);return"".concat(String(Math.floor(a/60)).padStart(2,"0"),":").concat(String(a%60).padStart(2,"0"))}function w(e){if(!e)return new Date;let[t,a,r]=e.split("-").map(Number);return new Date(t,(a||1)-1,r||1)}function j(e){let t=new Date(e),a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(l)}function N(e){let t=new Date(e);t.setHours(0,0,0,0);let a=t.getDay();return t.setDate(t.getDate()-(a+6)%7),t}function D(e){try{let t="focusCategories:week:".concat(j(N(e))),a=localStorage.getItem(t);if(a){let e=JSON.parse(a);if(Array.isArray(e))return e}}catch(e){}return function(){try{let e=localStorage.getItem("focusCategories"),t=e?JSON.parse(e):[];return Array.isArray(t)?t:[]}catch(e){return[]}}()}function k(e){return w(e).toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric"})}function M(e){let t=new Date(e);return t.setDate(1),t.setHours(0,0,0,0),t}function S(e,t){let a=new Date(e);return a.setMonth(a.getMonth()+t),a}function E(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function C(e){let t=M(e),a=new Date(t);a.setDate(1-t.getDay());let r=[];for(let e=0;e<35;e++){let t=new Date(a);t.setDate(a.getDate()+e),r.push(t)}return r}function L(e){let{valueYMD:t,onChange:a,onClose:s}=e,n=t?w(t):new Date,[o,i]=(0,l.useState)(M(n)),c=C(o),d=new Date;d.setHours(0,0,0,0);let u=w(t||j(new Date));return(0,r.jsxs)("div",{className:"absolute z-50 mt-1 w-72 rounded-lg border border-gray-200 bg-white shadow-lg p-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-1 pb-2",children:[(0,r.jsx)("button",{className:"px-2 py-1 rounded hover:bg-gray-100",onClick:()=>i(S(o,-1)),"aria-label":"Previous month",children:"‹"}),(0,r.jsx)("div",{className:"font-semibold text-[#374151]",children:o.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,r.jsx)("button",{className:"px-2 py-1 rounded hover:bg-gray-100",onClick:()=>i(S(o,1)),"aria-label":"Next month",children:"›"})]}),(0,r.jsx)("div",{className:"grid grid-cols-7 text-center text-[11px] text-gray-500",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>(0,r.jsx)("div",{className:"py-1",children:e},e))}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-1",children:c.map((e,l)=>{let n=e.getMonth()===o.getMonth(),i=t&&E(e,u),c=E(e,d);return(0,r.jsx)("button",{onClick:()=>{a&&a(j(e)),s&&s()},className:"h-9 rounded-md text-sm ".concat(n?"text-[#374151]":"text-gray-400"," ").concat(i?"bg-[#6B7280] text-white":"hover:bg-gray-100"," ").concat(c&&!i?"ring-1 ring-[#6B7280]":""),title:e.toDateString(),children:e.getDate()},l)})})]})}function T(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),a=n(),T=o(),Y=(0,l.useMemo)(()=>{let e=new Date;return e.setHours(0,0,0,0),e},[]),[P,F]=(0,l.useState)(null);(0,l.useEffect)(()=>{F(M(new Date))},[]);let[I,A]=(0,l.useState)(!1),[W,z]=(0,l.useState)("Month"),[H,O]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=new Date;e.setHours(0,0,0,0),O(e)},[]);let[R,U]=(0,l.useState)([]),[B,G]=(0,l.useState)(new Set);(0,l.useEffect)(()=>{U(D(new Date))},[]),(0,l.useEffect)(()=>{let e=e=>{e.key&&(e.key.startsWith("focusCategories")||"focusCategories"===e.key)&&H&&U(D(H))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[H]),(0,l.useEffect)(()=>{G(new Set(D(new Date).map(e=>e.label)));try{let e=localStorage.getItem("calendar:visibleFocusAreas");if(e){let t=new Set(JSON.parse(e));G(t)}}catch(e){}},[R]);let V=e=>{G(t=>{let a=new Set(t);a.has(e)?a.delete(e):a.add(e);try{localStorage.setItem("calendar:visibleFocusAreas",JSON.stringify([...a]))}catch(e){}return a})},q=(0,l.useCallback)(e=>e.filter(e=>!e.area||B.has(e.area)),[B]),[J,_]=(0,l.useState)(!1),[X,K]=(0,l.useState)(!1),[$,Z]=(0,l.useState)(()=>({...g,...p(new Date),dateYMD:j(new Date)}));(0,l.useEffect)(()=>{if((J||X)&&H){let e=D(H);U(e),Z(t=>(null==t?void 0:t.area)?(e||[]).some(e=>e.label===t.area)?t:{...t,area:""}:t)}},[J,X,H]);let Q=e=>{let t=(R||[]).find(t=>t.label===e);return(null==t?void 0:t.color)||h[2]},ee=(0,l.useMemo)(()=>["hourglassEvents:v1","calendarEvents","calendar-items","events"],[]),[et,ea]=(0,l.useState)([]),[er,el]=(0,l.useState)(!1),[es,en]=(0,l.useState)(!1),[eo,ei]=(0,l.useState)([]),[ec,ed]=(0,l.useState)(!1),[eu,eh]=(0,l.useState)(null),em="googleEventCustomizations:v1",[ex,eg]=(0,l.useState)({});(0,l.useEffect)(()=>{try{let e=localStorage.getItem(em);e&&eg(JSON.parse(e))}catch(e){console.warn("Failed to load Google event customizations:",e)}},[]),(0,l.useEffect)(()=>{try{localStorage.setItem(em,JSON.stringify(ex));try{window.dispatchEvent(new Event("calendarEventsUpdated"))}catch(e){}}catch(e){console.warn("Failed to save Google event customizations:",e)}},[ex]),(0,l.useEffect)(()=>{try{console.log("Calendar: Loading events on mount...");let e=[],t=new Set;for(let a of ee){let r=localStorage.getItem(a);if(console.log('Calendar: Checking localStorage key "'.concat(a,'":'),r?"has data":"empty"),r)try{let l=JSON.parse(r)||[];if(Array.isArray(l))for(let r of(console.log("Calendar: Found ".concat(l.length," events in ").concat(a,":"),l),l)){let a=r&&(r.id||"".concat(r.title||"","-").concat(r.start||""));a&&!t.has(a)&&(t.add(a),e.push(r))}}catch(e){console.warn("Calendar: Failed to parse ".concat(a,":"),e)}}console.log("Calendar: Total collected events:",e.length,e),e.length&&ea(e)}catch(e){console.warn("Failed to read events from storage",e)}finally{el(!0)}},[ee]),(0,l.useEffect)(()=>{if(er)try{let e=JSON.stringify(et);localStorage.setItem("hourglassEvents:v1",e),localStorage.setItem("calendarEvents",e)}catch(e){console.warn("Failed to write events to storage",e)}},[et,er]),(0,l.useEffect)(()=>{let e=e=>{if(e.key&&ee.includes(e.key))try{console.log("Calendar: Storage event detected:",e.key,e.newValue);let t=e.newValue?JSON.parse(e.newValue):null;Array.isArray(t)&&(console.log("Calendar: Updating events from storage event:",t),ea(t))}catch(e){console.warn("Calendar: Failed to parse storage event:",e)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[ee]),(0,l.useEffect)(()=>{let e=()=>{try{console.log("Calendar: Received calendarEventsUpdated event, refreshing events...");let e=[],t=new Set;for(let a of ee){let r=localStorage.getItem(a);if(r)try{console.log("Calendar: Reading from key:",a);let l=JSON.parse(r)||[];if(Array.isArray(l))for(let a of l){let r=a&&(a.id||"".concat(a.title||"","-").concat(a.start||""));r&&!t.has(r)&&(t.add(r),e.push(a))}}catch(e){}}console.log("Calendar: Updating events from localStorage:",{collectedCount:e.length,events:e}),ea(e)}catch(e){console.warn("Failed to read events from storage on calendarEventsUpdated",e)}};return window.addEventListener("calendarEventsUpdated",e),()=>window.removeEventListener("calendarEventsUpdated",e)},[ee]),(0,l.useEffect)(()=>{U(D(H)),Z(e=>(null==e?void 0:e.area)?(D(H)||[]).some(t=>t.label===e.area)?e:{...e,area:""}:e)},[H]);let ep=(0,l.useCallback)(async()=>{try{let e=await fetch("/api/auth/google/status"),t=await e.json();return en(t.connected||!1),t.connected||!1}catch(e){return console.error("Error checking Google connection:",e),en(!1),!1}},[]),ef=(0,l.useCallback)(async(e,t)=>{if(!es){ei([]);return}ed(!0),eh(null);try{var a;let r=new Date(e);r.setHours(0,0,0,0);let l=new Date(t);l.setHours(23,59,59,999),console.log("Fetching Google Calendar events:",{timeMin:r.toISOString(),timeMax:l.toISOString()});let s=await fetch("/api/calendar/google/events?timeMin=".concat(r.toISOString(),"&timeMax=").concat(l.toISOString()));if(console.log("Google Calendar API response status:",s.status),401===s.status){en(!1),ei([]);return}if(!s.ok){let e=await s.json().catch(()=>({}));throw console.error("Google Calendar API error:",{status:s.status,statusText:s.statusText,error:e}),Error(e.error||e.details||"Failed to fetch Google Calendar events")}let n=await s.json();console.log("Google Calendar events received:",(null===(a=n.events)||void 0===a?void 0:a.length)||0,"events"),ei(n.events||[]);try{localStorage.setItem("googleEvents:v1",JSON.stringify(n.events||[]))}catch(e){console.warn("Failed to store Google events in localStorage:",e)}}catch(e){console.error("Error fetching Google Calendar events:",e),eh(e.message),ei([])}finally{ed(!1)}},[es]);(0,l.useEffect)(()=>{a&&ep()},[a,ep]),(0,l.useEffect)(()=>{let e,t;if(a&&es){if("Day"===W&&H)e=new Date(H),t=new Date(H);else if("3 Day"===W&&H)e=new Date(H),(t=new Date(H)).setDate(t.getDate()+2);else if("Week"===W&&H){let a=f(H);e=new Date(a),(t=new Date(a)).setDate(t.getDate()+6)}else if("Month"===W){let a=P||(H?M(H):M(new Date));e=new Date(a);let r=new Date(a);r.setMonth(r.getMonth()+1),r.setDate(0),t=r}else{let a=new Date(e=M(new Date));a.setMonth(a.getMonth()+1),a.setDate(0),t=a}console.log("Triggering Google Calendar fetch for view:",W,{startDate:e.toISOString(),endDate:t.toISOString(),googleConnected:es,viewMonth:null==P?void 0:P.toISOString(),selectedDate:null==H?void 0:H.toISOString()}),ef(e,t)}},[a,es,W,H,P,ef]);let ev=(0,l.useMemo)(()=>{let e=new Set(et.map(e=>e.id));return[...et,...eo.map(e=>{let t=ex[e.id];return t?{...e,area:t.area||e.area,color:t.area?Q(t.area):e.color}:e}).filter(t=>!e.has(t.id))]},[et,eo,ex]);(0,l.useEffect)(()=>{if(!t)return;let a=t.get("new");if("1"!==a&&"true"!==a)return;let r=t.get("date"),l=t.get("focus");if(r)try{O(w(r))}catch(e){}Z(e=>({...g,...p(new Date),area:l?decodeURIComponent(l):e.area,dateYMD:r||j(H)})),_(!0);try{e.replace("/calendar",{scroll:!1})}catch(e){}},[t,e,H]),(0,l.useEffect)(()=>{if(!t)return;let a=t.get("edit");if(!a)return;let r=t.get("date"),l=t.get("view"),s=et.find(e=>e.id===a);if(s){if(r)try{let e=w(r);O(e)}catch(e){}else{let e=new Date(s.start);e.setHours(0,0,0,0),O(e)}"Day"===l&&z("Day"),eM(s.id),eE(Math.max(0,(s.end||0)-(s.start||0))||36e5),Z({title:s.title||"",area:s.area||"",dateYMD:r||j(new Date(s.start)),start:v(s.start),end:v(s.end),notes:s.notes||""}),K(!0);try{e.replace("/calendar",{scroll:!1})}catch(e){}}},[t,e,et]),(0,l.useMemo)(()=>H?H.toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric"}):"Loading...",[H]);let eb=(0,l.useRef)(null),ey=(0,l.useRef)([]),ew=(0,l.useRef)(null),ej=(0,l.useRef)(null),eN=(0,l.useRef)(null),eD=(0,l.useMemo)(()=>{let e=new Date(Y);return e.setDate(e.getDate()-14),Array.from({length:29},(t,a)=>{let r=new Date(e);return r.setDate(e.getDate()+a),r})},[Y]);(0,l.useEffect)(()=>{var e;if(!eb.current||!(null===(e=ey.current)||void 0===e?void 0:e.length)||!H)return;let t=eD.findIndex(e=>e.toDateString()===H.toDateString());if(-1===t)return;let a=ey.current[Math.max(0,t-1)];if(!a)return;let r=a.offsetLeft-24;eb.current.scrollTo({left:r,top:0,behavior:"smooth"})},[H,eD]),(0,l.useEffect)(()=>{if(eN.current&&R.length>0){let e=eN.current.clientWidth,t=eN.current.scrollWidth;eN.current.scrollTo({left:Math.max(0,(t-e)/2),top:0,behavior:"smooth"}),setTimeout(()=>{if(eN.current){let e=eN.current.clientWidth,t=eN.current.scrollWidth;eN.current.scrollTo({left:Math.max(0,(t-e)/2),top:0,behavior:"auto"})}},100)}},[R]);let[ek,eM]=(0,l.useState)(null),[eS,eE]=(0,l.useState)(36e5),[eC,eL]=(0,l.useState)(!1),[eT,eY]=(0,l.useState)("none"),[eP,eF]=(0,l.useState)({frequency:"weekly",interval:1,daysOfWeek:[],endDate:null}),[eI,eA]=(0,l.useState)(!1),[eW,ez]=(0,l.useState)(!1);(0,l.useRef)();let[eH,eO]=(0,l.useState)(!1);(0,l.useRef)();let eR=e=>{H&&(Z({...g,dateYMD:j(H),start:"".concat(String(e).padStart(2,"0"),":00"),end:23===e?"23:59":"".concat(String(e+1).padStart(2,"0"),":00")}),_(!0))},eU=e=>{let{title:t,area:a,start:r,end:l,color:s,notes:n,repeatType:o,customRepeat:i,baseDate:c}=e,d=[],u=new Date(r),h=new Date(l).getTime()-u.getTime(),m=new Date(u);m.setFullYear(m.getFullYear()+1);let g=new Date(u),p=0;for(;g<=m&&p<365;){let e=new Date(g),r=new Date(e.getTime()+h);if(d.push({id:x(),title:t,area:a,start:e.getTime(),end:r.getTime(),color:s,notes:n,isRepeating:!0,repeatType:o,originalDate:u.getTime()}),"daily"===o)g.setDate(g.getDate()+1);else if("weekly"===o)g.setDate(g.getDate()+7);else if("monthly"===o)g.setMonth(g.getMonth()+1);else if("yearly"===o)g.setFullYear(g.getFullYear()+1);else if("custom"===o){if("daily"===i.frequency)g.setDate(g.getDate()+i.interval);else if("weekly"===i.frequency){if(i.daysOfWeek.length>0){let e=g.getDay(),t=null;for(let a=1;a<=7;a++){let r=(e+a)%7;if(i.daysOfWeek.includes(r)){t=r;break}}if(null!==t){let a=(t-e+7)%7;g.setDate(g.getDate()+a)}else g.setDate(g.getDate()+(7-e)+i.daysOfWeek[0]+(i.interval-1)*7)}else g.setDate(g.getDate()+7*i.interval)}else"monthly"===i.frequency?g.setMonth(g.getMonth()+i.interval):"yearly"===i.frequency&&g.setFullYear(g.getFullYear()+i.interval)}p++}return d},eB=e=>{eM(e.id);let t="google"===e.source?ex[e.id]:null;eE(Math.max(0,(e.end||0)-(e.start||0))||36e5),Z({title:e.title||"",area:(null==t?void 0:t.area)||e.area||"",dateYMD:j(new Date(e.start)),start:v(e.start),end:v(e.end),notes:e.notes||""}),K(!0)},eG=async()=>{if(!ek)return;let e=ev.find(e=>e.id===ek);if((null==e?void 0:e.source)==="google"){try{let t=w($.dateYMD||j(H)),a=e=>{let[a,r]=e.split(":").map(Number),l=new Date(t);return l.setHours(a,r,0,0),l.getTime()},r=a($.start),l=a($.end);l<=r&&(l+=864e5);let s=new Date(r),n=new Date(l),o=await fetch("/api/calendar/google/events/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:ek,title:$.title||$.area||e.title,start:s.toISOString(),end:n.toISOString(),description:$.notes||""})});if(!o.ok){let e=await o.json().catch(()=>({})),t=e.details||e.error||"HTTP ".concat(o.status,": ").concat(o.statusText);if(403===o.status||403===e.code)throw Error("Permission denied. Please disconnect and reconnect Google Calendar to grant write permissions.");throw Error(t)}if($.area&&eg(e=>({...e,[ek]:{area:$.area||""}})),P){let e=new Date(P),t=new Date(P);t.setMonth(t.getMonth()+1),t.setDate(0),ef(e,t)}K(!1),eM(null)}catch(e){console.error("Error updating Google Calendar event:",e),alert("Failed to update Google Calendar event: ".concat(e.message))}return}let t=w($.dateYMD||j(H)),a=e=>{let[a,r]=e.split(":").map(Number),l=new Date(t);return l.setHours(a,r,0,0),l.getTime()},r=a($.start),l=a($.end);l<=r&&(l+=864e5),ea(et.map(e=>e.id===ek?{...e,title:$.title||$.area,area:$.area||"",start:r,end:l,color:Q($.area||e.area),notes:$.notes||""}:e)),K(!1),eM(null)},eV=function(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!ek)return;let a=et.find(e=>e.id===ek);if(a){if("google"===a.source)return;if(t&&a.isRepeating){let t=new Date(a.start);e=et.filter(e=>e.isRepeating&&e.originalDate===a.originalDate&&e.title===a.title?new Date(e.start)<t:e.id!==ek)}else e=et.filter(e=>e.id!==ek);ea(e),K(!1),eM(null)}},eq=()=>{if(!ek)return;let e=et.find(e=>e.id===ek);if(!e)return;let t=new Date(e.start);t.setDate(t.getDate()+1),Z({title:e.title||"",area:e.area||"",dateYMD:j(t),start:v(e.start),end:v(e.end),notes:""}),K(!1),eM(null),_(!0)},[eJ,e_]=(0,l.useState)(0);(0,l.useEffect)(()=>{e_(Date.now());let e=setInterval(()=>e_(Date.now()),3e4);return()=>clearInterval(e)},[]);let eX=e=>3e5*Math.round(e/3e5),[eK,e$]=(0,l.useState)(null),[eZ,eQ]=(0,l.useState)(null),[e0,e2]=(0,l.useState)(!1),[e1,e4]=(0,l.useState)(null),[e3,e6]=(0,l.useState)(null),[e5,e9]=(0,l.useState)(null),[e7,e8]=(0,l.useState)(null),te=(0,l.useRef)({startY:0,origStart:0,origEnd:0,duration:0,lastStartMs:null,moved:!1}),tt=(0,l.useRef)({startY:0,origStart:0,origEnd:0,lastStartMs:null,lastEndMs:null,moved:!1}),ta=(e,t,a)=>{tr.current&&(clearTimeout(tr.current),tr.current=null),e2(!1),e4(null),e6(e.id),e9(t),tt.current={startY:a,origStart:e.start,origEnd:e.end,lastStartMs:e.start,lastEndMs:e.end,moved:!1}},tr=(0,l.useRef)(null),tl=(0,l.useRef)(null),ts=(0,l.useRef)(!1),tn=(0,l.useMemo)(()=>{if(!H)return 0;let e=new Date(H);return e.setHours(0,0,0,0),e.getTime()},[H]),to=(0,l.useMemo)(()=>tn?tn+864e5:0,[tn]),ti=(0,l.useCallback)((e,t)=>{let a=t-e,r=Math.max(tn,Math.min(e,to-a));return[r,r+a]},[tn,to]),tc=(0,l.useMemo)(()=>{if(!H||!eJ)return null;let e=new Date(eJ);return e.getFullYear()!==H.getFullYear()||e.getMonth()!==H.getMonth()||e.getDate()!==H.getDate()?null:(60*e.getHours()+e.getMinutes())/60*64},[eJ,H,64]);(0,l.useEffect)(()=>{if(null==tc||!ej.current)return;let e="calendar:hasInitiallyScrolled";if("true"===localStorage.getItem(e))return;let t=setTimeout(()=>{if(!ej.current)return;let t=ej.current.getBoundingClientRect(),a=window.scrollY+t.top;window.scrollTo({top:Math.max(0,a+tc-240),behavior:"smooth"}),localStorage.setItem(e,"true")},2e3);return()=>clearTimeout(t)},[tc]),(0,l.useEffect)(()=>{if(!eK)return;let e=document.body.style.touchAction,t=document.body.style.userSelect;document.body.style.touchAction="none",document.body.style.userSelect="none";let a=e=>{e.cancelable&&e.preventDefault();let t=(e.touches?e.touches[0].clientY:e.clientY)-te.current.startY,a=te.current.origStart+t/64*36e5,r=a+te.current.duration;r=(a=eX(a))+te.current.duration,[a,r]=ti(a,r),te.current.lastStartMs=a,te.current.moved=!0;let l=new Date(Math.max(a,tn));eQ(Math.max(0,(l.getHours()+l.getMinutes()/60)*64))},r=()=>{if(ts.current)return;let e=te.current.moved,t=te.current.lastStartMs,a=te.current.duration;if(e$(null),eQ(null),te.current={startY:0,origStart:0,origEnd:0,duration:0,lastStartMs:null,moved:!1},!e||null==t)return;let r=t+a;ea(e=>e.map(e=>e.id===eK?{...e,start:t,end:r}:e))};return window.addEventListener("mousemove",a,{passive:!1}),window.addEventListener("mouseup",r,{passive:!0}),window.addEventListener("touchmove",a,{passive:!1}),window.addEventListener("touchend",r,{passive:!0}),()=>{document.body.style.touchAction=e,document.body.style.userSelect=t,window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",r),window.removeEventListener("touchmove",a),window.removeEventListener("touchend",r)}},[eK,64,tn,to,ti]),(0,l.useEffect)(()=>{if(!e3||!e5)return;let e=document.body.style.touchAction,t=document.body.style.userSelect;document.body.style.touchAction="none",document.body.style.userSelect="none";let a=e=>{e.cancelable&&e.preventDefault();let t=((e.touches?e.touches[0].clientY:e.clientY)-tt.current.startY)/64*36e5,a=tt.current.origStart,r=tt.current.origEnd;"top-left"===e5||"top-right"===e5?a=Math.min(a=eX(a=tt.current.origStart+t),r-9e5):("bottom-left"===e5||"bottom-right"===e5)&&(r=Math.max(r=eX(r=tt.current.origEnd+t),a+9e5)),[a,r]=ti(a,r),tt.current.lastStartMs=a,tt.current.lastEndMs=r,tt.current.moved=!0,e8({start:a,end:r})},r=()=>{if(ts.current)return;let e=tt.current.moved,t=tt.current.lastStartMs,a=tt.current.lastEndMs;e6(null),e9(null),e8(null),tt.current={startY:0,origStart:0,origEnd:0,lastStartMs:null,lastEndMs:null,moved:!1},e&&null!=t&&null!=a&&ea(e=>e.map(e=>e.id===e3?{...e,start:t,end:a}:e))};return window.addEventListener("mousemove",a,{passive:!1}),window.addEventListener("mouseup",r,{passive:!0}),window.addEventListener("touchmove",a,{passive:!1}),window.addEventListener("touchend",r,{passive:!0}),()=>{document.body.style.touchAction=e,document.body.style.userSelect=t,window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",r),window.removeEventListener("touchmove",a),window.removeEventListener("touchend",r)}},[e3,e5,64,tn,to,ti,eX]),(0,l.useEffect)(()=>()=>{tr.current&&clearTimeout(tr.current)},[]),(0,l.useEffect)(()=>{let e=()=>{tr.current&&(clearTimeout(tr.current),tr.current=null),e$(null),eQ(null),document.body.style.touchAction="",document.body.style.userSelect="",e2(!1),e4(null)};return window.addEventListener("pagehide",e),window.addEventListener("blur",e),document.addEventListener("visibilitychange",e),()=>{ts.current=!0,window.removeEventListener("pagehide",e),window.removeEventListener("blur",e),document.removeEventListener("visibilitychange",e),e()}},[]),(0,l.useEffect)(()=>{eK&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))},[eK]),(0,l.useEffect)(()=>{if(!a)return;let e=document.querySelectorAll(".calendar-event"),t=e=>{let t=e.currentTarget.getAttribute("data-event-id");if(!t)return;let a=et.find(e=>e.id===t);if(!a)return;tr.current&&clearTimeout(tr.current);let r=e.touches[0];tl.current={x:r.clientX,y:r.clientY},e2(!0),e4(a.id),tr.current=setTimeout(()=>{if(ts.current)return;let e=a.end-a.start;e$(a.id),e2(!1),e4(null),te.current={startY:r.clientY,origStart:a.start,origEnd:a.end,duration:e,lastStartMs:null,moved:!1};let t=new Date(Math.max(a.start,tn));eQ(Math.max(0,(t.getHours()+t.getMinutes()/60)*64))},500)},r=e=>{var t,a,r,l;if(!e0||!e1)return;let s=e.touches&&e.touches[0];if(!s)return;let n=null!==(r=null===(t=tl.current)||void 0===t?void 0:t.x)&&void 0!==r?r:s.clientX,o=null!==(l=null===(a=tl.current)||void 0===a?void 0:a.y)&&void 0!==l?l:s.clientY;Math.hypot(s.clientX-n,s.clientY-o)>10&&(tr.current&&(clearTimeout(tr.current),tr.current=null),e2(!1),e4(null))},l=()=>{e0&&e1&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))};return e.forEach(e=>{e.addEventListener("touchstart",t,{passive:!1}),e.addEventListener("touchmove",r,{passive:!0}),e.addEventListener("touchend",l,{passive:!1}),e.addEventListener("touchcancel",l,{passive:!1})}),()=>{e.forEach(e=>{e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",r),e.removeEventListener("touchend",l),e.removeEventListener("touchcancel",l)})}},[a,et,tn,64,e0,e1]);let td=(0,l.useMemo)(()=>tn&&to?q(ev.filter(e=>e.end>tn&&e.start<to)):[],[ev,tn,to,B,q]),tu=(0,l.useMemo)(()=>{if(!td.length)return new Map;let e=new Map,t=new Set,a=(e,t)=>e.start<t.end&&e.end>t.start;return td.forEach(r=>{if(t.has(r.id))return;let l=td.filter(e=>!t.has(e.id)&&a(r,e));if(1===l.length)e.set(r.id,{column:0,totalColumns:1,width:1,left:0}),t.add(r.id);else{l.sort((e,t)=>e.start!==t.start?e.start-t.start:e.end-t.end);let r=Array(l.length).fill(0);l.forEach((e,t)=>{let s=new Set;l.forEach((l,n)=>{n<t&&a(e,l)&&s.add(r[n])});let n=0;for(;s.has(n);)n++;r[t]=n});let s=Math.max(...r)+1,n=(1-.02*(s-1))/s;l.forEach((a,l)=>{let o=r[l];e.set(a.id,{column:o,totalColumns:s,width:n,left:o*n+.02*o}),t.add(a.id)})}}),e},[td]);if(H&&c[H.getDay()],!P)return(0,r.jsx)("div",{className:"min-h-screen bg-white text-[#374151] flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-lg font-semibold mb-2",children:"Loading Calendar..."}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Please wait while we prepare your calendar view."})]})});let th=C(P),tm=e=>{j(e);let t=new Date(e);t.setHours(0,0,0,0);let a=new Date(e);return a.setHours(23,59,59,999),q(ev.filter(e=>{let r=new Date(e.start),l=new Date(e.end);return r<=a&&l>=t}))},tx=(e,t,a)=>{if(!e.length)return new Map;let r=new Map,l=new Set,s=(e,t)=>e.start<t.end&&e.end>t.start;return e.forEach(t=>{if(l.has(t.id))return;let a=e.filter(e=>!l.has(e.id)&&s(t,e));if(1===a.length)r.set(t.id,{column:0,totalColumns:1,width:1,left:0}),l.add(t.id);else{a.sort((e,t)=>e.start!==t.start?e.start-t.start:e.end-t.end);let e=Array(a.length).fill(0);a.forEach((t,r)=>{let l=new Set;a.forEach((a,n)=>{n<r&&s(t,a)&&l.add(e[n])});let n=0;for(;l.has(n);)n++;e[r]=n});let t=Math.max(...e)+1,n=(1-.02*(t-1))/t;a.forEach((a,s)=>{let o=e[s];r.set(a.id,{column:o,totalColumns:t,width:n,left:o*n+.02*o}),l.add(a.id)})}}),r};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 via-purple-50 to-pink-50 text-white pb-24",children:[(0,r.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50",children:(0,r.jsx)("div",{className:"bg-white/70 backdrop-blur-xl border-b border-white/30 shadow-lg",style:{paddingTop:"".concat(Math.max(T.top,44),"px")},children:(0,r.jsxs)("header",{className:"px-4 pt-4 pb-4 flex items-center justify-between relative",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("button",{onClick:()=>A(!0),className:"text-gray-900 hover:opacity-70 transition-all duration-200 p-2","aria-label":"Open menu",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),(0,r.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-2",children:"Day"===W?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"text-lg px-2 text-gray-900 hover:text-gray-700","aria-label":"Previous Day",onClick:()=>H&&O(new Date(H.getFullYear(),H.getMonth(),H.getDate()-1)),disabled:!H,children:"‹"}),(0,r.jsx)("div",{className:"font-semibold text-base text-gray-900 whitespace-nowrap",children:H?H.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}):""}),(0,r.jsx)("button",{className:"text-lg px-2 text-gray-900 hover:text-gray-700","aria-label":"Next Day",onClick:()=>H&&O(new Date(H.getFullYear(),H.getMonth(),H.getDate()+1)),disabled:!H,children:"›"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"text-lg px-2 text-gray-900 hover:text-gray-700","aria-label":"Previous Month",onClick:()=>P&&F(S(P,-1)),disabled:!P,children:"‹"}),(0,r.jsx)("div",{className:"font-semibold text-lg text-gray-900",children:P?P.toLocaleDateString("en-US",{month:"long",year:"numeric"}):""}),(0,r.jsx)("button",{className:"text-lg px-2 text-gray-900 hover:text-gray-700","aria-label":"Next Month",onClick:()=>P&&F(S(P,1)),disabled:!P,children:"›"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Date;e.setHours(0,0,0,0),O(e),"Month"===W&&F(M(e))},title:"Go to today","aria-label":"Go to today",className:"inline-flex items-center justify-center w-10 h-10 rounded-xl bg-white/20 backdrop-blur-lg border border-white/20 shadow-lg text-gray-900 hover:bg-white/30 transition-all duration-200 font-semibold text-sm",children:Y.getDate()}),(0,r.jsx)("button",{onClick:()=>e.push("/settings"),title:"Settings","aria-label":"Settings",className:"inline-flex items-center justify-center w-10 h-10 rounded-xl bg-white/20 backdrop-blur-lg border border-white/20 shadow-lg text-gray-900 hover:bg-white/30 transition-all duration-200",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[(0,r.jsx)("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),(0,r.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]})]})})}),I&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40",onClick:()=>A(!1)}),(0,r.jsx)("div",{className:"fixed left-0 bottom-0 w-64 bg-white/95 backdrop-blur-xl border-r border-white/30 shadow-2xl z-50 overflow-y-auto scroll-smooth rounded-r-2xl",style:{top:"".concat(Math.max(T.top,44)+76,"px")},children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("button",{className:"w-full text-left px-4 py-3 rounded-lg transition-colors ".concat("Day"===W?"bg-white/30 text-gray-900 font-medium":"text-gray-900 hover:bg-white/20"),onClick:()=>{z("Day"),A(!1)},children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("span",{children:"Day"})]})}),(0,r.jsx)("button",{className:"w-full text-left px-4 py-3 rounded-lg transition-colors ".concat("3 Day"===W?"bg-white/30 text-gray-900 font-medium":"text-gray-900 hover:bg-white/20"),onClick:()=>{z("3 Day"),A(!1)},children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("span",{children:"3 Day"})]})}),(0,r.jsx)("button",{className:"w-full text-left px-4 py-3 rounded-lg transition-colors ".concat("Week"===W?"bg-white/30 text-gray-900 font-medium":"text-gray-900 hover:bg-white/20"),onClick:()=>{z("Week"),A(!1)},children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("span",{children:"Week"})]})}),(0,r.jsx)("button",{className:"w-full text-left px-4 py-3 rounded-lg transition-colors ".concat("Month"===W?"bg-white/30 text-gray-900 font-medium":"text-gray-900 hover:bg-white/20"),onClick:()=>{z("Month"),A(!1)},children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("span",{children:"Month"})]})})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 px-4",children:"Focus Areas"}),(0,r.jsx)("div",{className:"space-y-2",children:R.length>0?R.map(t=>{let a=t.color||h[0],l=B.has(t.label);return(0,r.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-white/20 transition-colors",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),V(t.label)},className:"flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",style:{backgroundColor:l?a:"transparent",borderColor:a},"aria-label":"".concat(l?"Hide":"Show"," ").concat(t.label),children:l&&(0,r.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"flex-1 flex items-center gap-3 cursor-pointer",onClick:()=>{e.push("/?focus=".concat(encodeURIComponent(t.label))),A(!1)},children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:a}}),(0,r.jsx)("span",{className:"text-sm text-gray-900 truncate",children:t.label})]})]},t.label)}):(0,r.jsx)("div",{className:"px-4 py-2 text-sm text-gray-600",children:"No focus areas yet"})})]})]})})]}),"Day"===W?(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 scroll-smooth",style:{paddingTop:"".concat(Math.max(T.top,44)+80,"px")},children:[H&&0===td.length&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Nothing planned"})}),(0,r.jsx)("div",{ref:ew,className:"relative",children:(0,r.jsx)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-[56px_minmax(0,1fr)]",children:[(0,r.jsx)("div",{className:"flex flex-col items-end pr-2",children:a&&i.map(e=>(0,r.jsx)("div",{className:"text-xs text-gray-700 flex items-start",style:{height:"".concat(64,"px")},children:(0,r.jsx)("div",{className:"-translate-y-1",children:d(e)})},e))}),(0,r.jsxs)("div",{ref:ej,className:"relative border-l border-gray-300/60 overflow-visible",style:{touchAction:eK?"none":void 0,userSelect:eK?"none":void 0},children:[i.map(e=>(0,r.jsx)("div",{className:"h-16 border-b border-gray-200/50 hover:bg-white/10 cursor-pointer transition-colors",onClick:()=>eR(e)},e)),a&&null!=tc&&(0,r.jsxs)("div",{className:"pointer-events-none absolute inset-x-0 z-20",style:{top:Math.max(0,Math.min(tc,1535))+"px"},children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",className:"absolute -left-3 -translate-y-1/2",style:{top:0},"aria-hidden":"true",children:[(0,r.jsx)("rect",{x:"6",y:"2.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("rect",{x:"6",y:"18.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M8 6c0 3.2 2.2 4.7 4 6-1.8 1.3-4 2.8-4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M16 6c0 3.2-2.2 4.7-4 6 1.8 1.3 4 2.8 4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,r.jsx)("div",{className:"absolute right-0 -translate-y-full mb-1 px-1.5 py-0.5 text-[10px] rounded bg-red-500 text-white shadow",style:{top:0},"aria-hidden":"true",children:u(eJ)}),(0,r.jsx)("div",{className:"h-[2px] bg-red-500 w-full"})]}),a&&td.map(e=>{let t=e3===e.id&&e7?e7.start:e.start,a=e3===e.id&&e7?e7.end:e.end,l=Math.max(t,tn),s=Math.min(a,to),n=new Date(l),o=(n.getHours()+n.getMinutes()/60)*64,i=Q(e.area)||e.color||h[2],c=tu.get(e.id)||{column:0,totalColumns:1,width:1,left:0},d=100*c.width,u=100*c.left;return(0,r.jsxs)("div",{"data-event-id":e.id,className:"absolute rounded-md shadow calendar-event select-none ".concat(eK===e.id?"cursor-grabbing":e0&&e1===e.id?"cursor-wait":e3===e.id?"cursor-ns-resize":"cursor-grab"),style:{top:(eK===e.id&&null!=eZ?eZ:Math.max(0,o))+"px",height:Math.max(24,(s-l)/36e5*64)+"px",left:"".concat(u,"%"),width:"".concat(d,"%"),background:m(i,e0&&e1===e.id?.2:e3===e.id?.7:.4),borderLeft:"3px solid ".concat(i),willChange:eK===e.id||e3===e.id?"top, height":void 0,opacity:e0&&e1===e.id?.7:e3===e.id?.9:1,touchAction:eK===e.id||e3===e.id?"none":"pan-y"},title:e.title,onMouseDown:t=>{t.target.closest("[data-resize-handle]")||(t.preventDefault(),t.stopPropagation(),tr.current&&clearTimeout(tr.current),e2(!0),e4(e.id),tr.current=setTimeout(()=>{if(ts.current)return;let a=e.end-e.start;e$(e.id),e2(!1),e4(null),te.current={startY:t.clientY,origStart:e.start,origEnd:e.end,duration:a,lastStartMs:null,moved:!1};let r=new Date(Math.max(e.start,tn));eQ(Math.max(0,(r.getHours()+r.getMinutes()/60)*64))},500))},onMouseUp:t=>{e0&&e1===e.id&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))},onMouseLeave:t=>{e0&&e1===e.id&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))},onClick:t=>{te.current.moved||tt.current.moved?(t.cancelable&&t.preventDefault(),t.stopPropagation()):eB(e)},children:[(0,r.jsxs)("div",{className:"text-[11px] px-2 py-1 leading-tight",children:[(0,r.jsx)("div",{className:"font-semibold truncate",children:e.title}),e.area&&(0,r.jsx)("div",{className:"text-[10px] opacity-70 truncate",children:e.area})]}),!eK&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute top-0 left-0 w-6 h-6 cursor-ns-resize select-none ".concat((e.id,"opacity-0")),onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),ta(e,"top-left",t.clientY)},onTouchStart:t=>{t.stopPropagation(),t.preventDefault(),t.touches[0]&&ta(e,"top-left",t.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute top-0 right-0 w-6 h-6 cursor-ns-resize select-none ".concat((e.id,"opacity-0")),onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),ta(e,"top-right",t.clientY)},onTouchStart:t=>{t.stopPropagation(),t.preventDefault(),t.touches[0]&&ta(e,"top-right",t.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute bottom-0 left-0 w-6 h-6 cursor-ns-resize select-none ".concat((e.id,"opacity-0")),onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),ta(e,"bottom-left",t.clientY)},onTouchStart:t=>{t.stopPropagation(),t.preventDefault(),t.touches[0]&&ta(e,"bottom-left",t.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute bottom-0 right-0 w-6 h-6 cursor-ns-resize select-none ".concat((e.id,"opacity-0")),onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),ta(e,"bottom-right",t.clientY)},onTouchStart:t=>{t.stopPropagation(),t.preventDefault(),t.touches[0]&&ta(e,"bottom-right",t.touches[0].clientY)}})]})]},e.id)})]})]})})}),(0,r.jsx)("div",{className:"mt-6 pb-6",children:(0,r.jsxs)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Daily Data Split"}),(()=>{let e=H?new Date(H):new Date;e.setHours(0,0,0,0);let t=H?new Date(H):new Date;t.setHours(23,59,59,999),e.getTime(),t.getTime();let a=R.map((e,t)=>{let a=Number(e.goal||0),r=0;if(H&&e.days){let t=c[H.getDay()];"object"==typeof e.days&&void 0!==e.days[t]&&(r=Number(e.days[t])||0)}return{label:e.label,color:e.color||h[t%h.length],dailyGoal:a,dailyPlanned:a,actualTimeLogged:r}}),l=a.reduce((e,t)=>e+t.actualTimeLogged,0),s=a.filter(e=>e.actualTimeLogged>0).map(e=>({...e,percentage:l>0?e.actualTimeLogged/l*100:0})).sort((e,t)=>t.percentage-e.percentage),n=2*Math.PI*50,o=(e,t,a,r)=>{let l=(e-90)*Math.PI/180,s=(t-90)*Math.PI/180,n=130+Math.cos(l)*a,o=130+Math.sin(l)*a,i=130+Math.cos(l)*r,c=130+Math.sin(l)*r,d=130+Math.cos(s)*a,u=130+Math.sin(s)*a,h=130+Math.cos(s)*r,m=130+Math.sin(s)*r,x=t-e>180?1:0;return"M ".concat(n," ").concat(o," L ").concat(i," ").concat(c," A ").concat(r," ").concat(r," 0 ").concat(x," 1 ").concat(h," ").concat(m," L ").concat(d," ").concat(u," A ").concat(a," ").concat(a," 0 ").concat(x," 0 ").concat(n," ").concat(o," Z")},i=0,d=s.map(e=>{let t=e.percentage/100*n,a=i/n*360,r=(i+t)/n*360,l={area:e,dashLength:t,startAngle:a,endAngle:r,midAngle:(a+r)/2,offset:i};return i+=t,l}),u=24-Number(localStorage.getItem("sleepHours")||8)-Number(localStorage.getItem("miscHours")||0);return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4 -mt-4 min-h-[260px] pl-4 pr-6",children:[(0,r.jsx)("div",{className:"flex-shrink-0 relative flex items-center justify-center",style:{width:"260px",height:"260px"},children:(0,r.jsxs)("svg",{width:"260",height:"260",viewBox:"0 0 260 260",children:[(0,r.jsx)("circle",{cx:130,cy:130,r:50,fill:"none",stroke:"#000000",strokeWidth:"16",strokeOpacity:"0.5"}),[...d].reverse().map((e,t)=>{let a=e.area,l=50+((d.length-1-t)%2==0?30:50),s=(e.midAngle-90)*Math.PI/180,n=130+Math.cos(s)*l,i=130+Math.sin(s)*l;return(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:o(e.startAngle,e.endAngle,40,60),fill:a.color,stroke:"none"}),(0,r.jsxs)("text",{x:n,y:i,textAnchor:"middle",dominantBaseline:"middle",className:"text-xs font-semibold",style:{fill:a.color},children:[a.percentage.toFixed(1),"%"]})]},a.label)})]})}),(0,r.jsx)("div",{className:"flex-1 flex items-center",children:(0,r.jsx)("div",{className:"space-y-2 w-full",children:s.length>0?s.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,r.jsx)("span",{className:"text-xs text-gray-900",children:e.label}),(0,r.jsxs)("span",{className:"text-xs text-gray-600 ml-auto",children:[Math.round(10*e.actualTimeLogged)/10,"/",Math.round(e.dailyPlanned)]})]},e.label)):(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"No focus areas yet. Add them from the dashboard."})})})]}),(0,r.jsx)("div",{className:"text-center mt-2 px-4",children:(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Unlogged time: ",Math.round(10*Math.max(0,u-l))/10,"/",Math.round(10*u)/10," hours"]})})]})})()]})})]}):"3 Day"===W?(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-4 scroll-smooth",style:{paddingTop:"".concat(Math.max(T.top,44)+80,"px")},children:(()=>{if(!H)return null;let e=new Date(H);e.setHours(0,0,0,0);let t=new Date(e);t.setDate(t.getDate()+1);let l=new Date(e);l.setDate(l.getDate()+2);let s=[e,t,l].map(e=>{let t=new Date(e);t.setHours(0,0,0,0);let a=new Date(e);a.setHours(23,59,59,999);let r=t.getTime(),l=a.getTime(),s=q(ev.filter(e=>e.end>r&&e.start<l)),n=tx(s,r,l);return{date:e,dayStartMs:r,dayEndMs:l,events:s,layouts:n}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:ew,className:"relative",children:(0,r.jsx)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-[56px_repeat(3,minmax(0,1fr))]",children:[(0,r.jsx)("div",{className:"flex flex-col items-end pr-2",children:a&&i.map(e=>(0,r.jsx)("div",{className:"text-xs text-gray-700 flex items-start",style:{height:"".concat(64,"px")},children:(0,r.jsx)("div",{className:"-translate-y-1",children:d(e)})},e))}),s.map((e,t)=>{let l=E(e.date,Y)&&a&&null!=tc;return(0,r.jsxs)("div",{className:"relative border-l border-gray-300/60 overflow-visible",style:{touchAction:eK?"none":void 0,userSelect:eK?"none":void 0},children:[(0,r.jsx)("div",{className:"sticky top-0 z-10 bg-white/30 backdrop-blur-sm border-b border-gray-300/60 px-2 py-1 mb-0",children:(0,r.jsx)("div",{className:"text-xs font-semibold text-gray-900",children:e.date.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})}),i.map(t=>(0,r.jsx)("div",{className:"h-16 border-b border-gray-200/50 hover:bg-white/10 cursor-pointer transition-colors",onClick:()=>{let a=new Date(e.date);O(a),setTimeout(()=>{Z({...g,dateYMD:j(a),start:"".concat(String(t).padStart(2,"0"),":00"),end:23===t?"23:59":"".concat(String(t+1).padStart(2,"0"),":00")}),_(!0)},0)}},t)),l&&(0,r.jsxs)("div",{className:"pointer-events-none absolute inset-x-0 z-20",style:{top:Math.max(0,Math.min(tc,1535))+32+"px"},children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",className:"absolute -left-3 -translate-y-1/2",style:{top:0},"aria-hidden":"true",children:[(0,r.jsx)("rect",{x:"6",y:"2.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("rect",{x:"6",y:"18.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M8 6c0 3.2 2.2 4.7 4 6-1.8 1.3-4 2.8-4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M16 6c0 3.2-2.2 4.7-4 6 1.8 1.3 4 2.8 4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,r.jsx)("div",{className:"absolute right-0 -translate-y-full mb-1 px-1.5 py-0.5 text-[10px] rounded bg-red-500 text-white shadow",style:{top:0},"aria-hidden":"true",children:u(eJ)}),(0,r.jsx)("div",{className:"h-[2px] bg-red-500 w-full"})]}),a&&e.events.map(t=>{let a=e3===t.id&&e7?e7.start:t.start,l=e3===t.id&&e7?e7.end:t.end,s=Math.max(a,e.dayStartMs),n=Math.min(l,e.dayEndMs),o=new Date(s),i=(o.getHours()+o.getMinutes()/60)*64,c=Q(t.area)||t.color||h[2],d=e.layouts.get(t.id)||{column:0,totalColumns:1,width:1,left:0},u=100*d.width,x=100*d.left;return(0,r.jsxs)("div",{"data-event-id":t.id,className:"absolute rounded-md shadow calendar-event select-none ".concat(eK===t.id?"cursor-grabbing":e0&&e1===t.id?"cursor-wait":e3===t.id?"cursor-ns-resize":"cursor-grab"),style:{top:(eK===t.id&&null!=eZ?eZ:Math.max(32,i+32))+"px",height:Math.max(24,(n-s)/36e5*64)+"px",left:"".concat(x,"%"),width:"".concat(u,"%"),background:m(c,e0&&e1===t.id?.2:e3===t.id?.7:.4),borderLeft:"3px solid ".concat(c),willChange:eK===t.id||e3===t.id?"top, height":void 0,opacity:e0&&e1===t.id?.7:e3===t.id?.9:1,touchAction:eK===t.id||e3===t.id?"none":"pan-y"},title:t.title,onMouseDown:a=>{a.target.closest("[data-resize-handle]")||(a.preventDefault(),a.stopPropagation(),tr.current&&clearTimeout(tr.current),e2(!0),e4(t.id),tr.current=setTimeout(()=>{if(ts.current)return;let r=t.end-t.start;e$(t.id),e2(!1),e4(null),te.current={startY:a.clientY,origStart:t.start,origEnd:t.end,duration:r,lastStartMs:null,moved:!1};let l=new Date(Math.max(t.start,e.dayStartMs));eQ(Math.max(32,(l.getHours()+l.getMinutes()/60)*64+32))},500))},onMouseUp:e=>{e0&&e1===t.id&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))},onMouseLeave:e=>{e0&&e1===t.id&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))},onClick:e=>{te.current.moved||tt.current.moved?(e.cancelable&&e.preventDefault(),e.stopPropagation()):eB(t)},children:[(0,r.jsxs)("div",{className:"text-[11px] px-2 py-1 leading-tight",children:[(0,r.jsx)("div",{className:"font-semibold truncate",children:t.title}),t.area&&(0,r.jsx)("div",{className:"text-[10px] opacity-70 truncate",children:t.area})]}),!eK&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute top-0 left-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"top-left",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"top-left",e.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute top-0 right-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"top-right",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"top-right",e.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute bottom-0 left-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"bottom-left",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"bottom-left",e.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute bottom-0 right-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"bottom-right",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"bottom-right",e.touches[0].clientY)}})]})]},t.id)})]},t)})]})})}),(0,r.jsx)("div",{className:"mt-6 pb-6",children:(0,r.jsxs)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"3 Day Data Split"}),(()=>{let e=H?new Date(H):new Date;e.setHours(0,0,0,0);let t=new Date(e);t.setDate(t.getDate()+1);let a=new Date(e);a.setDate(a.getDate()+2);let l=[e,t,a],s=R.map((e,t)=>{let a=Number(e.goal||0),r=0;if(e.days&&"object"==typeof e.days)for(let t=0;t<3;t++){let a=c[l[t].getDay()];void 0!==e.days[a]&&(r+=Number(e.days[a])||0)}return{label:e.label,color:e.color||h[t%h.length],dailyGoal:a,threeDayGoal:3*a,actualTimeLogged:r}}),n=s.reduce((e,t)=>e+t.actualTimeLogged,0),o=s.filter(e=>e.actualTimeLogged>0).map(e=>({...e,percentage:n>0?e.actualTimeLogged/n*100:0})).sort((e,t)=>t.percentage-e.percentage),i=3*(24-Number(localStorage.getItem("sleepHours")||8)-Number(localStorage.getItem("miscHours")||0)),d=0,u=2*Math.PI*50;return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4 -mt-4 min-h-[260px] pl-4 pr-6",children:[(0,r.jsx)("div",{className:"flex-shrink-0 relative flex items-center justify-center",style:{width:"260px",height:"260px"},children:(0,r.jsxs)("svg",{width:"260",height:"260",viewBox:"0 0 260 260",children:[(0,r.jsx)("circle",{cx:130,cy:130,r:50,fill:"none",stroke:"#000000",strokeWidth:"16",strokeOpacity:"0.5"}),o.map((e,t)=>{let a=e.percentage/100*u,l=-d,s=50+(t%2==0?30:50),n=(d/u*360+(d+a)/u*360)/2*Math.PI/180,o=130+Math.cos(n)*s,i=130+Math.sin(n)*s;return d+=a,(0,r.jsxs)("g",{children:[(0,r.jsx)("circle",{cx:130,cy:130,r:50,fill:"none",stroke:e.color,strokeWidth:"20",strokeDasharray:"".concat(a," ").concat(u),strokeDashoffset:l,strokeLinecap:"butt"}),(0,r.jsxs)("text",{x:o,y:i,textAnchor:"middle",dominantBaseline:"middle",className:"text-xs font-semibold",style:{fill:e.color},children:[e.percentage.toFixed(1),"%"]})]},e.label)})]})}),(0,r.jsx)("div",{className:"flex-1 flex items-center",children:(0,r.jsx)("div",{className:"space-y-2 w-full",children:o.length>0?o.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,r.jsx)("span",{className:"text-xs text-gray-900",children:e.label}),(0,r.jsxs)("span",{className:"text-xs text-gray-600 ml-auto",children:[Math.round(10*e.actualTimeLogged)/10,"/",Math.round(e.threeDayGoal)]})]},e.label)):(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"No focus areas yet. Add them from the dashboard."})})})]}),(0,r.jsx)("div",{className:"text-center mt-2 px-4",children:(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Unlogged time: ",Math.round(10*Math.max(0,i-n))/10,"/",Math.round(10*i)/10," hours"]})})]})})()]})})]})})()}):"Week"===W?(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-4 scroll-smooth",style:{paddingTop:"".concat(Math.max(T.top,44)+80,"px")},children:(()=>{if(!H)return null;let e=f(H),t=Array.from({length:7},(t,a)=>{let r=new Date(e);return r.setDate(e.getDate()+a),r.setHours(0,0,0,0),r}).map(e=>{let t=new Date(e);t.setHours(0,0,0,0);let a=new Date(e);a.setHours(23,59,59,999);let r=t.getTime(),l=a.getTime(),s=q(ev.filter(e=>e.end>r&&e.start<l)),n=tx(s,r,l);return{date:e,dayStartMs:r,dayEndMs:l,events:s,layouts:n}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:ew,className:"relative",children:(0,r.jsx)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-[56px_repeat(7,minmax(0,1fr))]",children:[(0,r.jsx)("div",{className:"flex flex-col items-end pr-2",children:a&&i.map(e=>(0,r.jsx)("div",{className:"text-xs text-gray-700 flex items-start",style:{height:"".concat(64,"px")},children:(0,r.jsx)("div",{className:"-translate-y-1",children:d(e)})},e))}),t.map((e,t)=>{let l=E(e.date,Y),s=l&&a&&null!=tc;return(0,r.jsxs)("div",{className:"relative border-l border-gray-300/60 overflow-visible",style:{touchAction:eK?"none":void 0,userSelect:eK?"none":void 0},children:[(0,r.jsxs)("div",{className:"sticky top-0 z-10 backdrop-blur-sm border-b border-gray-300/60 px-2 py-1 mb-0 ".concat(l?"bg-blue-100/50":"bg-white/30"),children:[(0,r.jsx)("div",{className:"text-xs font-semibold ".concat(l?"text-blue-700":"text-gray-900"),children:e.date.toLocaleDateString("en-US",{weekday:"short"})}),(0,r.jsx)("div",{className:"text-xs ".concat(l?"text-blue-600 font-medium":"text-gray-600"),children:e.date.getDate()})]}),i.map(t=>(0,r.jsx)("div",{className:"h-16 border-b border-gray-200/50 hover:bg-white/10 cursor-pointer transition-colors",onClick:()=>{let a=new Date(e.date);O(a),setTimeout(()=>{Z({...g,dateYMD:j(a),start:"".concat(String(t).padStart(2,"0"),":00"),end:23===t?"23:59":"".concat(String(t+1).padStart(2,"0"),":00")}),_(!0)},0)}},t)),s&&(0,r.jsxs)("div",{className:"pointer-events-none absolute inset-x-0 z-20",style:{top:Math.max(0,Math.min(tc,1535))+48+"px"},children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",className:"absolute -left-3 -translate-y-1/2",style:{top:0},"aria-hidden":"true",children:[(0,r.jsx)("rect",{x:"6",y:"2.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("rect",{x:"6",y:"18.5",width:"12",height:"3",rx:"1.5",stroke:"#ef4444",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M8 6c0 3.2 2.2 4.7 4 6-1.8 1.3-4 2.8-4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M16 6c0 3.2-2.2 4.7-4 6 1.8 1.3 4 2.8 4 6",stroke:"#ef4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,r.jsx)("div",{className:"absolute right-0 -translate-y-full mb-1 px-1.5 py-0.5 text-[10px] rounded bg-red-500 text-white shadow",style:{top:0},"aria-hidden":"true",children:u(eJ)}),(0,r.jsx)("div",{className:"h-[2px] bg-red-500 w-full"})]}),a&&e.events.map(t=>{let a=e3===t.id&&e7?e7.start:t.start,l=e3===t.id&&e7?e7.end:t.end,s=Math.max(a,e.dayStartMs),n=Math.min(l,e.dayEndMs),o=new Date(s),i=(o.getHours()+o.getMinutes()/60)*64,c=Q(t.area)||t.color||h[2],d=e.layouts.get(t.id)||{column:0,totalColumns:1,width:1,left:0},u=100*d.width,x=100*d.left;return(0,r.jsxs)("div",{"data-event-id":t.id,className:"absolute rounded-md shadow calendar-event select-none ".concat(eK===t.id?"cursor-grabbing":e0&&e1===t.id?"cursor-wait":e3===t.id?"cursor-ns-resize":"cursor-grab"),style:{top:(eK===t.id&&null!=eZ?eZ:Math.max(48,i+48))+"px",height:Math.max(24,(n-s)/36e5*64)+"px",left:"".concat(x,"%"),width:"".concat(u,"%"),background:m(c,e0&&e1===t.id?.2:e3===t.id?.7:.4),borderLeft:"3px solid ".concat(c),willChange:eK===t.id||e3===t.id?"top, height":void 0,opacity:e0&&e1===t.id?.7:e3===t.id?.9:1,touchAction:eK===t.id||e3===t.id?"none":"pan-y"},title:t.title,onMouseDown:a=>{a.target.closest("[data-resize-handle]")||(a.preventDefault(),a.stopPropagation(),tr.current&&clearTimeout(tr.current),e2(!0),e4(t.id),tr.current=setTimeout(()=>{if(ts.current)return;let r=t.end-t.start;e$(t.id),e2(!1),e4(null),te.current={startY:a.clientY,origStart:t.start,origEnd:t.end,duration:r,lastStartMs:null,moved:!1};let l=new Date(Math.max(t.start,e.dayStartMs));eQ(Math.max(48,(l.getHours()+l.getMinutes()/60)*64+48))},500))},onMouseUp:e=>{e0&&e1===t.id&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))},onMouseLeave:e=>{e0&&e1===t.id&&(tr.current&&clearTimeout(tr.current),e2(!1),e4(null))},onClick:e=>{te.current.moved||tt.current.moved?(e.cancelable&&e.preventDefault(),e.stopPropagation()):eB(t)},children:[(0,r.jsxs)("div",{className:"text-[11px] px-2 py-1 leading-tight",children:[(0,r.jsx)("div",{className:"font-semibold truncate",children:t.title}),t.area&&(0,r.jsx)("div",{className:"text-[10px] opacity-70 truncate",children:t.area})]}),!eK&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute top-0 left-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"top-left",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"top-left",e.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute top-0 right-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"top-right",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"top-right",e.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute bottom-0 left-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"bottom-left",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"bottom-left",e.touches[0].clientY)}}),(0,r.jsx)("div",{"data-resize-handle":!0,className:"absolute bottom-0 right-0 w-6 h-6 cursor-ns-resize select-none ".concat((t.id,"opacity-0")),onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),ta(t,"bottom-right",e.clientY)},onTouchStart:e=>{e.stopPropagation(),e.preventDefault(),e.touches[0]&&ta(t,"bottom-right",e.touches[0].clientY)}})]})]},t.id)})]},t)})]})})}),(0,r.jsx)("div",{className:"mt-6 pb-6",children:(0,r.jsxs)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Weekly Data Split"}),(()=>{let e=f(H),t=new Date(e);t.setDate(e.getDate()+6),t.setHours(23,59,59,999);let a=R.map((t,a)=>{let r=0;if(t.days&&"object"==typeof t.days)for(let a=0;a<7;a++){let l=new Date(e);l.setDate(e.getDate()+a);let s=c[l.getDay()];void 0!==t.days[s]&&(r+=Number(t.days[s])||0)}let l=Number(t.goal||0);return{label:t.label,color:t.color||h[a%h.length],dailyGoal:l,weeklyGoal:7*l,actualTimeLogged:r}}),l=a.reduce((e,t)=>e+t.actualTimeLogged,0),s=a.filter(e=>e.actualTimeLogged>0).map(e=>({...e,percentage:l>0?e.actualTimeLogged/l*100:0})).sort((e,t)=>t.percentage-e.percentage),n=7*(24-Number(localStorage.getItem("sleepHours")||8)-Number(localStorage.getItem("miscHours")||0)),o=0,i=2*Math.PI*50;return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4 -mt-4 min-h-[260px] pl-4 pr-6",children:[(0,r.jsx)("div",{className:"flex-shrink-0 relative flex items-center justify-center",style:{width:"260px",height:"260px"},children:(0,r.jsxs)("svg",{width:"260",height:"260",viewBox:"0 0 260 260",children:[(0,r.jsx)("circle",{cx:130,cy:130,r:50,fill:"none",stroke:"#000000",strokeWidth:"16",strokeOpacity:"0.5"}),s.map((e,t)=>{let a=e.percentage/100*i,l=-o,s=50+(t%2==0?30:50),n=(o/i*360+(o+a)/i*360)/2*Math.PI/180,c=130+Math.cos(n)*s,d=130+Math.sin(n)*s;return o+=a,(0,r.jsxs)("g",{children:[(0,r.jsx)("circle",{cx:130,cy:130,r:50,fill:"none",stroke:e.color,strokeWidth:"20",strokeDasharray:"".concat(a," ").concat(i),strokeDashoffset:l,strokeLinecap:"butt"}),(0,r.jsxs)("text",{x:c,y:d,textAnchor:"middle",dominantBaseline:"middle",className:"text-xs font-semibold",style:{fill:e.color},children:[e.percentage.toFixed(1),"%"]})]},e.label)})]})}),(0,r.jsx)("div",{className:"flex-1 flex items-center",children:(0,r.jsx)("div",{className:"space-y-2 w-full",children:s.length>0?s.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,r.jsx)("span",{className:"text-xs text-gray-900",children:e.label}),(0,r.jsxs)("span",{className:"text-xs text-gray-600 ml-auto",children:[Math.round(10*e.actualTimeLogged)/10,"/",Math.round(e.weeklyGoal)]})]},e.label)):(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"No focus areas yet. Add them from the dashboard."})})})]}),(0,r.jsx)("div",{className:"text-center mt-2 px-4",children:(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Unlogged time: ",Math.round(10*Math.max(0,n-l))/10,"/",Math.round(10*n)/10," hours"]})})]})})()]})})]})})()}):"Month"===W?(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-4 scroll-smooth",style:{paddingTop:"".concat(Math.max(T.top,44)+80,"px")},children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:[(0,r.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["S","M","T","W","T","F","S"].map((e,t)=>(0,r.jsx)("div",{className:"text-center text-xs font-semibold text-gray-900 py-2",children:e},t))}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-1",children:th.map((e,t)=>{let a=e.getMonth()===P.getMonth(),l=E(e,Y),s=tm(e);return(0,r.jsxs)("div",{className:"h-[80px] p-1 rounded-md border flex flex-col ".concat(a?"bg-white/40 backdrop-blur-sm hover:bg-white/50 border-gray-300/60":"bg-white/20 border-gray-200/40"," ").concat(l?"ring-2 ring-slate-500 border-slate-400":""," transition-all cursor-pointer"),onClick:()=>{O(new Date(e)),z("Day")},children:[(0,r.jsx)("div",{className:"text-sm font-medium text-center flex-shrink-0 h-8 flex items-center justify-center ".concat(a?"text-gray-900":"text-gray-500"," ").concat(l?"text-slate-600":""),children:l?(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-500 text-white flex items-center justify-center mx-auto",children:e.getDate()}):e.getDate()}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-1 px-1 flex-shrink-0 mt-auto",children:[s.slice(0,3).map(e=>{let t=Q(e.area)||e.color||h[2];return(0,r.jsx)("div",{className:"w-2 h-2 rounded-full flex-shrink-0 pointer-events-none",style:{backgroundColor:t},title:e.title},e.id)}),s.length>3&&(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-400 flex items-center justify-center flex-shrink-0 pointer-events-none",children:(0,r.jsx)("span",{className:"text-[8px] text-white leading-none",children:"+"})})]})]},t)})})]})})}):null,"Month"===W&&(0,r.jsx)("div",{className:"px-4 mt-6 pb-6",children:(0,r.jsxs)("div",{className:"bg-white/20 backdrop-blur-lg rounded-xl border border-white/20 shadow-xl p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Data Split"}),(()=>{let e=P?new Date(P.getFullYear(),P.getMonth()+1,0).getDate():30,t=P?new Date(P.getFullYear(),P.getMonth(),1):new Date;t.setHours(0,0,0,0);let a=P?new Date(P.getFullYear(),P.getMonth()+1,0):new Date;a.setHours(23,59,59,999);let l=t.getTime(),s=a.getTime(),n=e=>(e||"").trim().toLowerCase(),o=R.map((t,a)=>{let r=Number(t.goal||0),o=0,i=new Date(l),d=new Date(s),u=new Map;for(let e=new Date(i);e<=d;e.setDate(e.getDate()+1)){let a=j(N(e)),r=u.get(a);if(!r){let e="focusCategories:week:".concat(a);try{let l=localStorage.getItem(e);l&&(r=JSON.parse(l).find(e=>n(e.label)===n(t.label)))&&u.set(a,r)}catch(e){}}if(r&&r.days&&"object"==typeof r.days){let t=c[e.getDay()];void 0!==r.days[t]&&(o+=Number(r.days[t])||0)}}return 0===o&&(t.days&&"object"==typeof t.days?o=Object.values(t.days).reduce((e,t)=>e+(Number(t)||0),0):t.timeSpent&&(o=Number(t.timeSpent)||0)),{label:t.label,color:t.color||h[a%h.length],dailyGoal:r,monthlyPlanned:r*e,actualTimeLogged:o}}),i=o.reduce((e,t)=>e+t.actualTimeLogged,0),d=o.filter(e=>e.actualTimeLogged>0).map(e=>({...e,percentage:i>0?e.actualTimeLogged/i*100:0})).sort((e,t)=>t.percentage-e.percentage),u=0,m=2*Math.PI*50;return(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4 -mt-4 min-h-[260px] pl-4 pr-6",children:[(0,r.jsx)("div",{className:"flex-shrink-0 relative flex items-center justify-center",style:{width:"260px",height:"260px"},children:(0,r.jsxs)("svg",{width:"260",height:"260",viewBox:"0 0 260 260",children:[(0,r.jsx)("circle",{cx:130,cy:130,r:50,fill:"none",stroke:"#000000",strokeWidth:"16",strokeOpacity:"0.5"}),d.map((e,t)=>{let a=e.percentage/100*m,l=-u,s=50+(t%2==0?30:50),n=(u/m*360+(u+a)/m*360)/2*Math.PI/180,o=130+Math.cos(n)*s,i=130+Math.sin(n)*s;return u+=a,(0,r.jsxs)("g",{children:[(0,r.jsx)("circle",{cx:130,cy:130,r:50,fill:"none",stroke:e.color,strokeWidth:"20",strokeDasharray:"".concat(a," ").concat(m),strokeDashoffset:l,strokeLinecap:"butt"}),(0,r.jsxs)("text",{x:o,y:i,textAnchor:"middle",dominantBaseline:"middle",className:"text-xs font-semibold",style:{fill:e.color},children:[e.percentage.toFixed(1),"%"]})]},e.label)})]})}),(0,r.jsx)("div",{className:"flex-1 flex items-center",children:(0,r.jsx)("div",{className:"space-y-2 w-full",children:d.length>0?d.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,r.jsx)("span",{className:"text-xs text-gray-900",children:e.label}),(0,r.jsxs)("span",{className:"text-xs text-gray-600 ml-auto",children:[Math.round(e.actualTimeLogged),"/",Math.round(e.monthlyPlanned)]})]},e.label)):(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"No focus areas yet. Add them from the dashboard."})})})]})})()]})}),(0,r.jsx)("button",{onClick:()=>{O(new Date),Z({...g,...p(new Date),dateYMD:j(new Date)}),_(!0)},className:"fixed bottom-24 right-4 w-14 h-14 rounded-full bg-slate-500/80 backdrop-blur-lg text-white flex items-center justify-center shadow-xl border border-white/20 z-50 hover:bg-slate-600/80 transition-all","aria-label":"Add Event",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-3 pb-7 z-[9999]",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto grid grid-cols-3 gap-3",children:[(0,r.jsx)("button",{onClick:()=>e.push("/"),className:"h-12 w-full rounded-2xl bg-white/40 backdrop-blur-xl text-gray-700 font-medium border-2 border-white/50 hover:bg-white/50 transition-all duration-200 shadow-2xl",children:"Dashboard"}),(0,r.jsx)("button",{className:"h-12 w-full rounded-2xl bg-white/40 backdrop-blur-xl text-gray-700 font-semibold border-2 border-white/50 shadow-2xl",disabled:!0,"aria-current":"page",children:"Calendar"}),(0,r.jsx)("button",{onClick:()=>e.push("/search"),className:"h-12 w-full rounded-2xl bg-white/40 backdrop-blur-xl text-gray-700 font-medium border-2 border-white/50 hover:bg-white/50 transition-all duration-200 shadow-2xl",children:"Search"})]})}),J&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50 pb-20",children:(0,r.jsxs)("div",{className:"bg-white/95 backdrop-blur-xl rounded-xl shadow-2xl border-2 border-white/60 p-4 w-[92%] max-w-md ".concat(eI?"max-h-[90vh] flex flex-col":""),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-black",children:"New Event"}),(0,r.jsx)("button",{className:"text-sm text-black",onClick:()=>{_(!1),Z(g)},children:"Cancel"})]}),(0,r.jsxs)("div",{className:eI?"flex-1 overflow-y-auto":"",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"Title"}),(0,r.jsx)("input",{value:$.title,onChange:e=>Z({...$,title:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3 text-black",placeholder:"e.g., Product Development"}),(0,r.jsx)("label",{className:"text-sm text-black",children:"Focus Area"}),(0,r.jsxs)("select",{value:$.area,onChange:e=>Z({...$,area:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3 text-black",children:[(0,r.jsx)("option",{value:"",children:"(none)"}),R.map(e=>(0,r.jsx)("option",{value:e.label,children:e.label},e.label))]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full border",style:{background:Q($.area)}}),(0,r.jsx)("span",{className:"text-xs text-black",children:"Event color follows the Focus Area"})]}),(0,r.jsx)("label",{className:"text-sm text-black",children:"Date"}),(0,r.jsxs)("div",{className:"relative mb-3",children:[(0,r.jsx)("div",{role:"button",tabIndex:0,className:"w-full border rounded px-3 py-2 text-left bg-white cursor-pointer text-black",onClick:()=>ez(e=>!e),onKeyPress:e=>{("Enter"===e.key||" "===e.key)&&ez(e=>!e)},children:k($.dateYMD)}),eW&&(0,r.jsx)("div",{className:"absolute left-0 z-50",children:(0,r.jsx)(L,{valueYMD:$.dateYMD,onChange:e=>Z(t=>({...t,dateYMD:e})),onClose:()=>ez(!1)})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3 items-start overflow-hidden",children:[(0,r.jsxs)("div",{className:"pr-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"Start"}),(0,r.jsx)("input",{type:"time",value:$.start,onChange:e=>{let t=e.target.value,a=y(t,eS);Z(e=>({...e,start:t,end:a}))},className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px] text-black",min:"00:00",max:"23:59",style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:"pl-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"End"}),(0,r.jsx)("input",{type:"time",value:$.end,onChange:e=>Z({...$,end:e.target.value}),className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px] text-black",min:"00:00",max:"23:59",style:{width:"100%"}})]})]}),(0,r.jsx)("label",{className:"text-sm text-black",children:"Notes"}),(0,r.jsx)("textarea",{value:$.notes,onChange:e=>Z({...$,notes:e.target.value}),className:"w-full border rounded px-3 py-2 mb-4 text-black",rows:3,placeholder:"What will you accomplish during this timeframe?"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"isRepeating",checked:eC,onChange:e=>{eL(e.target.checked),e.target.checked||(eY("none"),eA(!1))},className:"w-4 h-4"}),(0,r.jsx)("label",{htmlFor:"isRepeating",className:"text-sm font-medium text-black",children:"Do you want this to be a repeating event?"})]}),eC&&(0,r.jsxs)("div",{className:"ml-6 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"Repeat"}),(0,r.jsxs)("select",{value:eT,onChange:e=>{eY(e.target.value),"custom"===e.target.value?eA(!0):eA(!1)},className:"w-full border rounded px-3 py-2 mt-1 text-black",children:[(0,r.jsx)("option",{value:"none",children:"None"}),(0,r.jsx)("option",{value:"daily",children:"Daily"}),(0,r.jsx)("option",{value:"weekly",children:"Weekly"}),(0,r.jsx)("option",{value:"monthly",children:"Monthly"}),(0,r.jsx)("option",{value:"yearly",children:"Yearly"}),(0,r.jsx)("option",{value:"custom",children:"Custom..."})]})]}),eI&&(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded border",children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"Frequency"}),(0,r.jsxs)("select",{value:eP.frequency,onChange:e=>eF({...eP,frequency:e.target.value}),className:"w-full border rounded px-3 py-2 mt-1 text-black",children:[(0,r.jsx)("option",{value:"daily",children:"Daily"}),(0,r.jsx)("option",{value:"weekly",children:"Weekly"}),(0,r.jsx)("option",{value:"monthly",children:"Monthly"}),(0,r.jsx)("option",{value:"yearly",children:"Yearly"})]})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"Every"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)("input",{type:"number",min:"1",max:"99",value:eP.interval,onChange:e=>eF({...eP,interval:parseInt(e.target.value)||1}),className:"w-16 border rounded px-2 py-1 text-center text-black"}),(0,r.jsx)("span",{className:"text-sm text-black",children:"daily"===eP.frequency?"day(s)":"weekly"===eP.frequency?"week(s)":"monthly"===eP.frequency?"month(s)":"year(s)"})]})]}),"weekly"===eP.frequency&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"Repeat on:"}),(0,r.jsx)("div",{className:"flex gap-1 mt-2",children:["S","M","T","W","T","F","S"].map((e,t)=>(0,r.jsx)("button",{type:"button",onClick:()=>{let e=eP.daysOfWeek.includes(t)?eP.daysOfWeek.filter(e=>e!==t):[...eP.daysOfWeek,t];eF({...eP,daysOfWeek:e})},className:"w-8 h-8 rounded text-xs font-medium ".concat(eP.daysOfWeek.includes(t)?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:e},t))})]}),(0,r.jsx)("div",{className:"text-xs text-black",children:"Events will repeat for up to 1 year from the start date."})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 ".concat(eI?"mt-4 flex-shrink-0":""),children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded text-black",onClick:()=>{_(!1),Z(g)},children:"Close"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-[#6B7280] text-white rounded",onClick:()=>{if(!$.title&&!$.area||!H)return;let e=w($.dateYMD||j(H)),t=t=>{let[a,r]=t.split(":").map(Number),l=new Date(e);return l.setHours(a,r,0,0),l.getTime()},a=t($.start),r=t($.end);r<=a&&(r+=864e5);let l=Q($.area);eC&&"none"!==eT?ea([...et,...eU({title:$.title||$.area,area:$.area||"",start:a,end:r,color:l,notes:$.notes||"",repeatType:eT,customRepeat:eP,baseDate:e})]):ea([...et,{id:x(),title:$.title||$.area,area:$.area||"",start:a,end:r,color:l,notes:$.notes||""}]),O(new Date(e)),_(!1),Z(g),eL(!1),eY("none"),eF({frequency:"weekly",interval:1,daysOfWeek:[],endDate:null})},children:"Add"})]})]})}),X&&(()=>{let e=ev.find(e=>e.id===ek),t=(null==e?void 0:e.source)==="google";return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50 pb-20",children:(0,r.jsxs)("div",{className:"bg-white/95 backdrop-blur-xl rounded-xl shadow-2xl border-2 border-white/60 p-4 w-[92%] max-w-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-black",children:t?"Edit Google Calendar Event":"Edit Event"}),(0,r.jsx)("button",{className:"text-sm text-black",onClick:()=>{K(!1),eM(null)},children:"Cancel"})]}),(0,r.jsx)("label",{className:"text-sm text-black",children:"Title"}),(0,r.jsx)("input",{value:$.title,onChange:e=>Z({...$,title:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3 text-black",placeholder:"e.g., Product Development"}),(0,r.jsx)("label",{className:"text-sm text-black",children:"Focus Area"}),(0,r.jsxs)("select",{value:$.area,onChange:e=>Z({...$,area:e.target.value}),className:"w-full border rounded px-3 py-2 mb-3 text-black",children:[(0,r.jsx)("option",{value:"",children:"(none)"}),R.map(e=>(0,r.jsx)("option",{value:e.label,children:e.label},e.label))]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full border",style:{background:Q($.area||"")}}),(0,r.jsx)("span",{className:"text-xs text-black",children:"Event color follows the Focus Area"})]}),(0,r.jsx)("label",{className:"text-sm text-black",children:"Date"}),(0,r.jsxs)("div",{className:"relative mb-3",children:[(0,r.jsx)("div",{role:"button",tabIndex:0,className:"w-full border rounded px-3 py-2 text-left bg-white cursor-pointer text-black",onClick:()=>eO(e=>!e),onKeyPress:e=>{("Enter"===e.key||" "===e.key)&&eO(e=>!e)},children:k($.dateYMD)}),eH&&(0,r.jsx)("div",{className:"absolute left-0 z-50",children:(0,r.jsx)(L,{valueYMD:$.dateYMD,onChange:e=>Z(t=>({...t,dateYMD:e})),onClose:()=>eO(!1)})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3 items-start overflow-hidden",children:[(0,r.jsxs)("div",{className:"pr-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"Start"}),(0,r.jsx)("input",{type:"time",value:$.start,onChange:e=>{let t=e.target.value,a=y(t,eS);Z(e=>({...e,start:t,end:a}))},className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px] text-black",min:"00:00",max:"23:59",style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:"pl-1 min-w-0",children:[(0,r.jsx)("label",{className:"text-sm text-black",children:"End"}),(0,r.jsx)("input",{type:"time",value:$.end,onChange:e=>{let t=e.target.value,a=Math.max(0,b(t)-b($.start));a>0&&eE(a),Z(e=>({...e,end:t}))},className:"w-full min-w-0 border rounded px-3 py-2 sm:max-w-full max-w-[160px] text-black",min:"00:00",max:"23:59",style:{width:"100%"}})]})]}),(0,r.jsx)("label",{className:"text-sm text-black",children:"Notes"}),(0,r.jsx)("textarea",{value:$.notes,onChange:e=>Z({...$,notes:e.target.value}),className:"w-full border rounded px-3 py-2 mb-4 text-black",rows:3,placeholder:"What will you accomplish during this timeframe?"}),!t&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(()=>{let e=et.find(e=>e.id===ek);return e&&e.isRepeating?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{className:"px-4 py-2 bg-red-500 text-white rounded text-xs leading-tight",onClick:()=>eV(!1),children:["Delete This",(0,r.jsx)("br",{}),"Event"]}),(0,r.jsxs)("button",{className:"px-4 py-2 bg-red-600 text-white rounded text-xs leading-tight",onClick:()=>eV(!0),children:["Delete Future",(0,r.jsx)("br",{}),"Events"]})]}):(0,r.jsx)("button",{className:"px-4 py-2 bg-red-500 text-white rounded",onClick:eV,children:"Delete"})})(),(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded text-black",onClick:eq,children:"Duplicate"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded text-black",onClick:()=>{K(!1),eM(null)},children:"Cancel"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-[#6B7280] text-white rounded",onClick:eG,children:"Save"})]})]}),t&&(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded text-black",onClick:()=>{K(!1),eM(null)},children:"Cancel"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-[#6B7280] text-white rounded",onClick:eG,children:"Save"})]})]})})})()]})}function Y(){return(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-[#F7F6F3] flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-[#374151]",children:"Loading calendar..."})}),children:(0,r.jsx)(T,{})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3587)}),_N_E=e.O()}]);