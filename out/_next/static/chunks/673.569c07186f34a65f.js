"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[673],{8673:function(e,t,o){function a(){try{let e={focusCategories:localStorage.getItem("focusCategories"),hourglassEvents:localStorage.getItem("hourglassEvents:v1"),calendarEvents:localStorage.getItem("calendarEvents"),googleEventCustomizations:localStorage.getItem("googleEventCustomizations:v1"),sleepHours:localStorage.getItem("sleepHours"),miscHours:localStorage.getItem("miscHours"),userName:localStorage.getItem("userName"),profilePicture:localStorage.getItem("profilePicture"),timeFormat:localStorage.getItem("timeFormat"),weekStart:localStorage.getItem("weekStart"),weekData:{},lastProcessedWeekKey:localStorage.getItem("lastProcessedWeekKey")},t=[];for(let e=0;e<localStorage.length;e++){let o=localStorage.key(e);o&&(o.startsWith("focusAreas:week:")||o.startsWith("week:"))&&t.push(o)}t.forEach(t=>{e.weekData[t]=localStorage.getItem(t)});let o=[];for(let e=0;e<localStorage.length;e++){let t=localStorage.key(e);t&&t.startsWith("notes:")&&o.push(t)}e.notes={},o.forEach(t=>{e.notes[t]=localStorage.getItem(t)});let a=[];for(let e=0;e<localStorage.length;e++){let t=localStorage.key(e);t&&t.startsWith("eventNotes:")&&a.push(t)}return e.eventNotes={},a.forEach(t=>{e.eventNotes[t]=localStorage.getItem(t)}),e}catch(e){return console.error("Error collecting app data:",e),null}}function r(e){try{if(!e)return;e.focusCategories&&localStorage.setItem("focusCategories",e.focusCategories),e.hourglassEvents&&localStorage.setItem("hourglassEvents:v1",e.hourglassEvents),e.calendarEvents&&localStorage.setItem("calendarEvents",e.calendarEvents),e.googleEventCustomizations&&localStorage.setItem("googleEventCustomizations:v1",e.googleEventCustomizations),void 0!==e.sleepHours&&(e.sleepHours?localStorage.setItem("sleepHours",e.sleepHours):localStorage.removeItem("sleepHours")),void 0!==e.miscHours&&(e.miscHours?localStorage.setItem("miscHours",e.miscHours):localStorage.removeItem("miscHours")),e.userName&&localStorage.setItem("userName",e.userName),e.profilePicture&&localStorage.setItem("profilePicture",e.profilePicture),e.timeFormat&&localStorage.setItem("timeFormat",e.timeFormat),e.weekStart&&localStorage.setItem("weekStart",e.weekStart),e.weekData&&Object.entries(e.weekData).forEach(e=>{let[t,o]=e;o&&localStorage.setItem(t,o)}),e.lastProcessedWeekKey&&localStorage.setItem("lastProcessedWeekKey",e.lastProcessedWeekKey),e.notes&&Object.entries(e.notes).forEach(e=>{let[t,o]=e;o&&localStorage.setItem(t,o)}),e.eventNotes&&Object.entries(e.eventNotes).forEach(e=>{let[t,o]=e;o&&localStorage.setItem(t,o)}),window.dispatchEvent(new Event("calendarEventsUpdated")),window.dispatchEvent(new Event("focusAreasUpdated")),window.dispatchEvent(new Event("syncDataApplied"))}catch(e){console.error("Error applying synced data:",e)}}async function s(){try{let e=a();if(!e)throw Error("Failed to collect data");let t=await fetch("/api/sync/data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to upload data")}return!0}catch(e){throw console.error("Error uploading data:",e),e}}async function l(){try{let e=await fetch("/api/sync/data");if(!e.ok){if(401===e.status)throw Error("Not authenticated");let t=await e.json();throw Error(t.error||"Failed to download data")}return(await e.json()).data}catch(e){throw console.error("Error downloading data:",e),e}}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"server";try{let t=await l();if(!t)return await s(),{action:"uploaded",data:null};if("server"===e)return r(t),{action:"downloaded",data:t};if("merge"!==e)return await s(),{action:"uploaded",data:null};{let e={...a(),...t};return r(e),await s(),{action:"merged",data:e}}}catch(e){throw console.error("Error syncing data:",e),e}}o.d(t,{hL:function(){return c},uploadData:function(){return s}})}}]);